# Runtime vs Gamma_Walo Diff

This report compares scripts in `runtime files/gamedata/scripts` against their counterparts in `gamma_walo/gamedata/scripts`.

| File | Added | Removed | Verdict |
| ---- | ----- | ------- | ------- |
| AGDD_voiced_actor.script | - | - | missing in gamma |
| BlueDots.script | - | - | missing in gamma |
| CB_RF_patch_mcm.script | - | - | missing in gamma |
| Free_ZoomV2.script | - | - | missing in gamma |
| Free_ZoomV2_mcm.script | - | - | missing in gamma |
| LevelChangeCars.script | - | - | missing in gamma |
| MoreVodkaTrades.script | - | - | missing in gamma |
| NimbleClearInventory.script | - | - | missing in gamma |
| NimbleTrade.script | - | - | missing in gamma |
| TB_Coordinate_Based_Safe_Zones.script | - | - | missing in gamma |
| TB_RF_Receiver_Packages.script | - | - | missing in gamma |
| TB_Remove_Bugged_Stashes.script | - | - | missing in gamma |
| Wait.script | - | - | missing in gamma |
| _g_patches.script | - | - | missing in gamma |
| _u.script | - | - | missing in gamma |
| a_arti_jamming_mcm.script | - | - | missing in gamma |
| a_faction_prices.script | - | - | missing in gamma |
| a_idiots_config.script | - | - | missing in gamma |
| a_idiots_mdata.script | - | - | missing in gamma |
| a_tab_utils.script | - | - | missing in gamma |
| a_taskboard_utils.script | - | - | missing in gamma |
| a_the_living_fire_configs.script | - | - | missing in gamma |
| a_wpo_parts.script | - | - | missing in gamma |
| aaa_hf_callbacks.script | - | - | missing in gamma |
| aaa_rax_icon_override.script | - | - | missing in gamma |
| aaa_rax_icon_override_mcm.script | - | - | missing in gamma |
| aaa_sound_object_patch.script | - | - | missing in gamma |
| aaaa_monkeys.script | - | - | missing in gamma |
| aaaa_script_fixes_mp.script | - | - | missing in gamma |
| aaaa_streamlined_mp.script | - | - | missing in gamma |
| ab_move_notification.script | - | - | missing in gamma |
| ace52_autoinject.script | - | - | missing in gamma |
| actor_effects.script | - | - | missing in gamma |
| actor_status.script | - | - | missing in gamma |
| actor_status_gasmask.script | - | - | missing in gamma |
| actor_status_sleep.script | - | - | missing in gamma |
| actor_status_thirst.script | - | - | missing in gamma |
| ads_reloads.script | - | - | missing in gamma |
| ag_colours.script | - | - | missing in gamma |
| ag_game_objects.script | - | - | missing in gamma |
| ag_logging.script | - | - | missing in gamma |
| ag_strings.script | - | - | missing in gamma |
| ag_tables.script | - | - | missing in gamma |
| agroprom_drugkit_spawner_gamma.script | - | - | missing in gamma |
| ah_dialogs.script | - | - | missing in gamma |
| alife_storage_manager.script | - | - | missing in gamma |
| alticons.script | - | - | missing in gamma |
| ammo_check_mcm.script | - | - | missing in gamma |
| ammo_maker.script | - | - | missing in gamma |
| animation_common.script | - | - | missing in gamma |
| anom_stash_trade.script | - | - | missing in gamma |
| anomalous_stash.script | - | - | missing in gamma |
| aol_anim_transitions.script | - | - | missing in gamma |
| aol_bbox.script | - | - | missing in gamma |
| aol_bshape.script | - | - | missing in gamma |
| aol_mp412_hangfire.script | - | - | missing in gamma |
| aol_mp412_monkeypatches.script | - | - | missing in gamma |
| aol_mp412_scopes.script | - | - | missing in gamma |
| aol_rotation.script | - | - | missing in gamma |
| aol_sprint_cancel.script | - | - | missing in gamma |
| arm.script | - | - | missing in gamma |
| arszi_mutant_bleeding.script | - | - | missing in gamma |
| arszi_psy.script | - | - | missing in gamma |
| arti_jamming.script | - | - | missing in gamma |
| augmented_trader_inject.script | - | - | missing in gamma |
| auto_looter_mcm.script | - | - | missing in gamma |
| axr_beh.script | - | - | missing in gamma |
| axr_beh_patches.script | - | - | missing in gamma |
| axr_companions.script | - | - | missing in gamma |
| axr_companions_va_gamma_patch.script | - | - | missing in gamma |
| axr_npc_vs_box.script | - | - | missing in gamma |
| aysd.script | - | - | missing in gamma |
| baba_yaga_configs.script | - | - | missing in gamma |
| bas_adder.script | - | - | missing in gamma |
| bas_nvg_scopes.script | - | - | missing in gamma |
| bas_nvg_scopes_mcm.script | - | - | missing in gamma |
| bas_trade_inject.script | - | - | missing in gamma |
| base_node_logic.script | 0 | 0 | keep |

<details><summary>Diff for base_node_logic.script</summary>
```diff
```
</details>
| battery_warning.script | - | - | missing in gamma |
| big_game_configs.script | - | - | missing in gamma |
| bind_anomaly_field.script | - | - | missing in gamma |
| bind_awr.script | - | - | missing in gamma |
| bind_campfire.script | - | - | missing in gamma |
| bind_crow.script | - | - | missing in gamma |
| bind_digital_clock_furniture.script | - | - | missing in gamma |
| bind_hf_base.script | - | - | missing in gamma |
| bind_hf_static.script | - | - | missing in gamma |
| bind_light_furniture.script | - | - | missing in gamma |
| bind_table_fan.script | - | - | missing in gamma |
| bind_workshop_furniture.script | - | - | missing in gamma |
| binoc_pistol_knife.script | - | - | missing in gamma |
| blacklist_helper.script | - | - | missing in gamma |
| bullet_time_mcm.script | - | - | missing in gamma |
| callbacks_gameobject.script | - | - | missing in gamma |
| camera_reanim_project.script | - | - | missing in gamma |
| camera_reanim_project_mcm.script | - | - | missing in gamma |
| camp_lum.script | - | - | missing in gamma |
| campfire_placeable.script | - | - | missing in gamma |
| campfire_placeable_mcm.script | - | - | missing in gamma |
| campfires_on_map_mcm.script | - | - | missing in gamma |
| catsy_customsquadsize_mcm.script | - | - | missing in gamma |
| catsy_fftd_mcm.script | - | - | missing in gamma |
| catsy_milpda_mcm.script | - | - | missing in gamma |
| catsy_nerfs_mcm.script | - | - | missing in gamma |
| catsy_paw_mcm.script | - | - | missing in gamma |
| check_anim.script | - | - | missing in gamma |
| chem_damage.script | - | - | missing in gamma |
| ciga_effects.script | - | - | missing in gamma |
| class_registrator.script | - | - | missing in gamma |
| class_registrator_modded_exes.script | - | - | missing in gamma |
| clear_jam.script | - | - | missing in gamma |
| clear_jam_mcm.script | - | - | missing in gamma |
| close_combat_weapons_launchers.script | - | - | missing in gamma |
| coffee_drink.script | - | - | missing in gamma |
| combine_all_items.script | - | - | missing in gamma |
| companion_anti_awol.script | - | - | missing in gamma |
| companion_anti_awol_mcm.script | - | - | missing in gamma |
| cozy_campfire.script | - | - | missing in gamma |
| cozy_campfire_mcm.script | - | - | missing in gamma |
| craft_use_in_tooltip_mcm.script | - | - | missing in gamma |
| craft_use_low_cond.script | - | - | missing in gamma |
| custom_companion_squad_size.script | - | - | missing in gamma |
| custom_functor_autoinject.script | - | - | missing in gamma |
| daily_sim_engine.script | 3 | 1 | keep |

<details><summary>Diff for daily_sim_engine.script</summary>
```diff
--- runtime files/gamedata/scripts/daily_sim_engine.script
+++ gamma_walo/gamedata/scripts/daily_sim_engine.script
@@ -4,7 +4,8 @@
     Runs the daily simulation cycle for Warfare overhaul. This ties together
     resource production, base consumption, transport task generation and squad
     spawning. Called once per in-game day by an external scheduler.
-    Last edit: 2025-07-26
+    Last edit: 2025-08-30
+    -- Modified by Codex: Implement Squad Loot Recovery integration
 ]]
 
 local node_system  = require 'node_system'
@@ -13,6 +14,7 @@
 local base_logic    = require 'base_node_logic'
 local coordinator   = require 'hq_coordinator'
 local spawn_system  = require 'squad_spawn_system'
+local loot_recovery = require 'squad_loot_recovery'
 local diplomacy     = require 'diplomacy_core'
 local faction_state = require 'faction_state'
 
```
</details>
| dar_rf_noise.script | - | - | missing in gamma |
| dead_device.script | - | - | missing in gamma |
| dead_night_configs.script | - | - | missing in gamma |
| death_manager.script | - | - | missing in gamma |
| demonized_concurrent_queues.script | - | - | missing in gamma |
| demonized_geometry_ray .script | - | - | missing in gamma |
| demonized_geometry_ray.script | - | - | missing in gamma |
| demonized_ledge_grabbing.script | - | - | missing in gamma |
| demonized_ledge_grabbing_animation_data.script | - | - | missing in gamma |
| demonized_ledge_grabbing_mcm.script | - | - | missing in gamma |
| demonized_randomizing_functions.script | - | - | missing in gamma |
| demonized_time_events.script | - | - | missing in gamma |
| descriptive_stash_coordinates.script | - | - | missing in gamma |
| despawn_guns.script | - | - | missing in gamma |
| despawn_monolith_grenades.script | - | - | missing in gamma |
| detec_bone_hide.script | - | - | missing in gamma |
| dialog_blackmarket.script | - | - | missing in gamma |
| dialog_fov.script | - | - | missing in gamma |
| dialog_fov_mcm.script | - | - | missing in gamma |
| dialogs.script | 3 | 0 | keep |

<details><summary>Diff for dialogs.script</summary>
```diff
--- runtime files/gamedata/scripts/dialogs.script
+++ gamma_walo/gamedata/scripts/dialogs.script
@@ -32,6 +32,7 @@
 	task_manager.get_task_manager():give_task("mar_find_doctor_task")
 end
 
+-- Helper used in dialog preconditions to hide options when Warfare is active
 function warfare_disabled(a,b)
 	if _G.WARFARE then
 		return false
@@ -43,6 +44,7 @@
 -- Task stacking check
 -------------------------------------------
 local mark_task_per_npc = {}
+-- Returns the maximum simultaneous tasks an NPC can offer based on options
 function get_npc_task_limit()
 	return tonumber(ui_options.get("gameplay/general/max_tasks") or 2)
 end
@@ -1793,7 +1795,7 @@
 -----------------------------------------------------------------------------------
 -- TRADE
 -----------------------------------------------------------------------------------
---' ������������� ��������
+--'  
 function trade_init(seller, buyer)
 	db.storage[seller:id()].meet.begin_wait_to_see.begin = time_global()/1000
 	xr_position.setPosition(db.storage[seller:id()].meet.Seller,
```
</details>
| dialogs_agr_u.script | - | - | missing in gamma |
| dialogs_army.script | - | - | missing in gamma |
| dialogs_devushka.script | - | - | missing in gamma |
| dialogs_hidden_threat.script | - | - | missing in gamma |
| dialogs_lostzone.script | - | - | missing in gamma |
| dialogs_mlr.script | - | - | missing in gamma |
| dialogs_yantar.script | - | - | missing in gamma |
| diplomacy_core.script | 0 | 0 | keep |

<details><summary>Diff for diplomacy_core.script</summary>
```diff
```
</details>
| diplomacy_system.script | 0 | 0 | keep |

<details><summary>Diff for diplomacy_system.script</summary>
```diff
```
</details>
| dit_mcm.script | - | - | missing in gamma |
| dotmarks_callbacks.script | - | - | missing in gamma |
| dotmarks_canteen_water_pumps.script | - | - | missing in gamma |
| dotmarks_hideout_furniture_mcm.script | - | - | missing in gamma |
| dotmarks_main.script | - | - | missing in gamma |
| dotmarks_mcm.script | - | - | missing in gamma |
| dph_debug_log.script | - | - | missing in gamma |
| dph_loot_cond_ammo_mcm.script | - | - | missing in gamma |
| dph_loot_cond_outfit_mcm.script | - | - | missing in gamma |
| dph_loot_cond_weapon_mcm.script | - | - | missing in gamma |
| dph_mcm_save_storage.script | - | - | missing in gamma |
| drx_da_main.script | - | - | missing in gamma |
| drx_da_main_artefacts.script | - | - | missing in gamma |
| drx_da_main_artefacts_movement.script | - | - | missing in gamma |
| drx_da_main_loadout_mcm.script | - | - | missing in gamma |
| drx_da_main_mcm.script | - | - | missing in gamma |
| drx_da_main_traders.script | - | - | missing in gamma |
| dryfire_prefire_sounds.script | - | - | missing in gamma |
| dxml_core.script | - | - | missing in gamma |
| dynamic_emission_cover_mcm.script | - | - | missing in gamma |
| dynamic_eq_icon.script | - | - | missing in gamma |
| dynamic_news_manager.script | - | - | missing in gamma |
| dynamic_news_manager_patch_dmg.script | - | - | missing in gamma |
| dynamic_npc_armor_visuals.script | - | - | missing in gamma |
| ea_callbacks.script | - | - | missing in gamma |
| ea_error.script | - | - | missing in gamma |
| ea_light.script | - | - | missing in gamma |
| ea_prefetcher.script | - | - | missing in gamma |
| eft_jump_sounds.script | - | - | missing in gamma |
| eft_jump_sounds_mcm.script | - | - | missing in gamma |
| eft_rattle.script | - | - | missing in gamma |
| eft_rattle_mcm.script | - | - | missing in gamma |
| emission_guard_patch.script | - | - | missing in gamma |
| enhanced_animations.script | - | - | missing in gamma |
| enhanced_animations_mcm.script | - | - | missing in gamma |
| exo_loot.script | - | - | missing in gamma |
| exo_mcm.script | - | - | missing in gamma |
| exo_power_activator_mcm.script | - | - | missing in gamma |
| exo_powers.script | - | - | missing in gamma |
| exo_servo_sounds.script | - | - | missing in gamma |
| exo_servo_sounds_mcm.script | - | - | missing in gamma |
| extended_movement_sounds_mcm.script | - | - | missing in gamma |
| extra_portraits_mcm.script | - | - | missing in gamma |
| factionID_hud_mcm.script | - | - | missing in gamma |
| faction_ai_logic.script | 0 | 0 | keep |

<details><summary>Diff for faction_ai_logic.script</summary>
```diff
```
</details>
| faction_expansions.script | 4 | 1 | keep |

<details><summary>Diff for faction_expansions.script</summary>
```diff
--- runtime files/gamedata/scripts/faction_expansions.script
+++ gamma_walo/gamedata/scripts/faction_expansions.script
@@ -7,7 +7,8 @@
 	2020/05/25 - Vintar
 	2020/05/31 - Vintar - lowered loner veteran chance
 	2021/02/27 - Vintar - lowered loner advanced/veteran chance again, removed rats from spawn
-	2021/03/02 - Vintar - removed black smoke poltergeist
+        2021/03/02 - Vintar - removed black smoke poltergeist
+        2025/07/24 - d0pe - documented spawn chance formulas
 
 	This file provides the chance for advanced/veteran squads to spawn instead of novice
 	squads, or picks a normal/rare mutant spawn section.
@@ -132,11 +133,13 @@
 
 -- old functions were overly complicated and had a weird minimum at 80% resource ownership where your squads would be worse on average
 -- new functions are monotonically increasing so that each point of resource is always a sizeable benefit
+-- Chance percentage for an advanced squad spawn given owned resources
 function get_advanced_chance(resource)
 --	return -1 * (100 * (1 / math.pow(warfare.resource_count / 2, 2))) * math.pow((resource - (warfare.resource_count / 2)), 2) + 100
 	return 150 * (math.pow((resource / warfare.resource_count), 0.8))
 end
 
+-- Chance percentage for a veteran squad spawn given owned resources
 function get_veteran_chance(resource)
 --	return -100 + (100 / (warfare.resource_count / 2)) * resource
 	return 100 * (math.pow((resource / warfare.resource_count), 2))
```
</details>
| faction_philosophy.script | 0 | 0 | keep |

<details><summary>Diff for faction_philosophy.script</summary>
```diff
```
</details>
| faction_state.script | 0 | 0 | keep |

<details><summary>Diff for faction_state.script</summary>
```diff
```
</details>
| fakelens.script | - | - | missing in gamma |
| fdda_time_events.script | - | - | missing in gamma |
| fetch_anomalous_stash.script | - | - | missing in gamma |
| fetch_item_icon.script | - | - | missing in gamma |
| fire_damage.script | - | - | missing in gamma |
| fire_queue_cancel.script | - | - | missing in gamma |
| fix_beefnvg_anim.script | - | - | missing in gamma |
| fluid_aim.script | - | - | missing in gamma |
| force_texture_lod.script | - | - | missing in gamma |
| fov_anim_manager.script | - | - | missing in gamma |
| freelook_state.script | - | - | missing in gamma |
| g36pack_traderinject.script | - | - | missing in gamma |
| game_achievements.script | - | - | missing in gamma |
| game_backpack_travel.script | - | - | missing in gamma |
| game_diff_override.script | - | - | missing in gamma |
| game_fast_travel.script | 0 | 0 | keep |

<details><summary>Diff for game_fast_travel.script</summary>
```diff
```
</details>
| game_relations.script | 113 | 102 | keep |

<details><summary>Diff for game_relations.script</summary>
```diff
--- runtime files/gamedata/scripts/game_relations.script
+++ gamma_walo/gamedata/scripts/game_relations.script
@@ -25,36 +25,35 @@
 	-- rank_goodwill 								- the relation of rank of the character to the rank of the actor from [rank_relations]
 
 --]]
+
+
 function safe_ini_r_float(ini, section, key, fallback)
-	if ini and ini:section_exist(section) and ini:line_exist(section, key) then
-		return ini:r_float(section, key)
-	else
-		return fallback
-	end
+        if ini and ini:section_exist(section) and ini:line_exist(section, key) then
+                return ini:r_float(section, key)
+        else
+                return fallback
+        end
 end
 
 function safe_ini_r_s32(ini, section, key, fallback)
-	if ini and ini:section_exist(section) and ini:line_exist(section, key) then
-		return ini:r_s32(section, key)
-	else
-		return fallback
-	end
-end
-
-
-
+        if ini and ini:section_exist(section) and ini:line_exist(section, key) then
+                return ini:r_s32(section, key)
+        else
+                return fallback
+        end
+end
 --========================================< Controls >========================================--
 local ini_r
 if system_ini():section_exist("plugins\\dynamic_faction_relations") then -- added escape fix
         ini_r = ini_file("plugins\\dynamic_faction_relations.ltx")
 else
-	printf("[game_relations.script] WARNING: Missing dynamic_faction_relations.ltx")
+        printf("[game_relations.script] WARNING: Missing dynamic_faction_relations.ltx")
 end
 local ini_g
 if system_ini():section_exist("creatures\\game_relations") then -- added escape fix
         ini_g = ini_file("creatures\\game_relations.ltx")
 else
-	printf("[game_relations.script] WARNING: Missing game_relations.ltx")
+        printf("[game_relations.script] WARNING: Missing game_relations.ltx")
 end
 factions_table = {"stalker","bandit","csky","dolg","freedom","killer","army","ecolog","monolith","renegade","greh","isg"}
 factions_table_all = {"actor","bandit","dolg","ecolog","freedom","killer","army","monolith","monster","stalker","zombied","csky","renegade","greh","isg","trader","actor_stalker","actor_bandit","actor_dolg","actor_freedom","actor_csky","actor_ecolog","actor_killer","actor_army","actor_monolith","actor_renegade","actor_greh","actor_isg","actor_zombied","arena_enemy"}
@@ -154,13 +153,14 @@
 		return false
 	end
 	
-	for i=1,#blacklist_pair do
-		if (blacklist_pair[i][1] == fac1) and (blacklist_pair[i][2] == fac2) then
-			return true
-		elseif (blacklist_pair[i][2] == fac1) and (blacklist_pair[i][1] == fac2) then
-			return true
-		end
-	end
+       for i=1,#blacklist_pair do
+               local pair = blacklist_pair[i]
+                if (pair[1] == fac1) and (pair[2] == fac2) then
+                        return true
+                elseif (pair[2] == fac1) and (pair[1] == fac2) then
+                        return true
+                end
+        end
 	return false
 end
 
@@ -189,13 +189,14 @@
 	end
 	
 	-- Check blacklisted pairs 
-	for i = 1, #blacklist_pair do
-		if (blacklist_pair[i][1] == faction_1) and (blacklist_pair[i][2] == faction_2) then
-			return false
-		elseif (blacklist_pair[i][2] == faction_1) and (blacklist_pair[i][1] == faction_2) then
-			return false
-		end
-	end
+       for i = 1, #blacklist_pair do
+               local pair = blacklist_pair[i]
+                if (pair[1] == faction_1) and (pair[2] == faction_2) then
+                        return false
+                elseif (pair[2] == faction_1) and (pair[1] == faction_2) then
+                        return false
+                end
+        end
 	
 	return true
 end
@@ -308,17 +309,20 @@
 
 function reset_all_relations()
 	local tbl = {}
-	for i=1, #factions_table_all do
-		local value = ini_g:r_string_ex("communities_relations" , factions_table_all[i])
-		tbl[factions_table_all[i]] = str_explode(value,",")
-	end
-	
-	for i=1,#factions_table_all do
-		for j=1,#factions_table_all do
-			set_factions_community_num( factions_table_all[i] , factions_table_all[j] , tonumber(tbl[factions_table_all[i]][j]) )
-			--printf("TRX - " .. factions_table_all[i] .. " + " .. factions_table_all[j] .. " = " .. tonumber(tbl[factions_table_all[i]][j]))
-		end
-	end
+       for i=1, #factions_table_all do
+               local faction = factions_table_all[i]
+               local value = ini_g:r_string_ex("communities_relations" , faction)
+               tbl[faction] = str_explode(value,",")
+       end
+
+       for i=1,#factions_table_all do
+               local faction_i = factions_table_all[i]
+               for j=1,#factions_table_all do
+                       local faction_j = factions_table_all[j]
+                       set_factions_community_num( faction_i , faction_j , tonumber(tbl[faction_i][j]) )
+                       --printf("TRX - " .. faction_i .. " + " .. faction_j .. " = " .. tonumber(tbl[faction_i][j]))
+               end
+       end
 end
 
 function calculate_relation_change( victim_tbl, killer_tbl)
@@ -356,18 +360,19 @@
 	local enemy_num = 0
 	local natural_num = 0
 	local friend_num = 0
-	for i=1,#factions_table do
-		if (victim_faction ~= factions_table[i]) then
-			local rel = get_factions_community( victim_faction , factions_table[i] )
-			if (rel <= -1000) then
-				enemy_num = enemy_num + 1
-			elseif (rel > -1000) and (rel < 1000) then
-				natural_num = natural_num + 1
-			elseif (rel > -1000) and (rel < 1000) then
-				friend_num = friend_num + 1
-			end
-		end
-	end
+       for i=1,#factions_table do
+               local faction = factions_table[i]
+               if (victim_faction ~= faction) then
+                       local rel = get_factions_community( victim_faction , faction )
+                       if (rel <= -1000) then
+                               enemy_num = enemy_num + 1
+                       elseif (rel > -1000) and (rel < 1000) then
+                                natural_num = natural_num + 1
+                        elseif (rel >= 1000) then -- fixed logic irrationality
+                                friend_num = friend_num + 1
+                        end
+                end
+        end
 	
 	-- return if killer and victim are from the same faction
 	if (killer_faction == victim_faction) then
@@ -376,9 +381,10 @@
 
 	-- If killed NPC was enemy of faction, raise relation toward killer faction:
 	if ( math.random( 100 ) > 50 ) then
-		for i = 1, #factions_table do
-			if ( factions_table[i] ~= killer_faction ) then
-				if ( is_factions_enemies( factions_table[i], victim_faction ) ) then
+               for i = 1, #factions_table do
+                       local faction = factions_table[i]
+                       if ( faction ~= killer_faction ) then
+                                if ( is_factions_enemies( faction, victim_faction ) ) then
 					if ( math.random( 100 ) > 50 ) then -- random faction picker
 						
 						-- Relation calculation:
@@ -397,8 +403,8 @@
 						
 						local value = math.floor( death_value * ( v_rank + ( k_rank / 5 ) ) * ( v_rep_bad + ( k_rep_good / 10 ) ) )
 						
-						if is_relation_allowed( factions_table[i] , killer_faction ) and ( natural_num + friend_num > friend_count_limit ) then
-							change_faction_relations( factions_table[i], killer_faction, value )
+                                                if is_relation_allowed( faction , killer_faction ) and ( natural_num + friend_num > friend_count_limit ) then
+                                                        change_faction_relations( faction, killer_faction, value )
 							--printf("- Relations: Relations positive change | " .. factions_table[i] .. " <-> " .. killer_faction .. " relation change = " .. value)
 						else
 							--printf("% Relations: Relations change | " .. factions_table[i] .. " <-> " .. killer_faction .. " relation can't be changed!")
@@ -415,9 +421,10 @@
 
 	-- If killed NPC was friend or neutral to faction, lower relation toward killer faction:
 	else
-		for i = 1, #factions_table do
-			if ( factions_table[i] ~= killer_faction ) then
-				if ( not is_factions_enemies( factions_table[i], victim_faction ) ) then
+               for i = 1, #factions_table do
+                       local faction = factions_table[i]
+                       if ( faction ~= killer_faction ) then
+                                if ( not is_factions_enemies( faction, victim_faction ) ) then
 					if ( math.random( 100 ) > 50 ) then -- random faction picker
 					
 						-- Relation calculation:
@@ -436,8 +443,8 @@
 						
 						local value = math.floor( death_value * ( v_rank + ( k_rank / 5 ) ) * ( v_rep_good + ( k_rep_bad / 10 ) ) )
 
-						if is_relation_allowed( factions_table[i] , killer_faction ) and ( enemy_num > enemy_count_limit ) then
-							change_faction_relations( factions_table[i], killer_faction, -(value) )
+                                                if is_relation_allowed( faction , killer_faction ) and ( enemy_num > enemy_count_limit ) then
+                                                        change_faction_relations( faction, killer_faction, -(value) )
 							--printf("- Relations: Relations negative change | " .. factions_table[i] .. " <-> " .. killer_faction .. " relation change = " .. -(value))
 						else
 							--printf("% Relations: Relations change | " .. factions_table[i] .. " <-> " .. killer_faction .. " relation can't be changed!")
@@ -456,24 +463,26 @@
 
 local rnd_enemy = {}
 function get_random_enemy_faction(comm)
-	empty_table(rnd_enemy)
-	for i = 1, #factions_table do
-		if (comm ~= factions_table[i]) and is_factions_enemies(factions_table[i], comm) and is_relation_allowed(factions_table[i] , comm) then
-			rnd_enemy[#rnd_enemy + 1] = factions_table[i]
-		end
-	end
-	return (#rnd_enemy > 0) and rnd_enemy[math.random(#rnd_enemy)] or nil
+       empty_table(rnd_enemy)
+       for i = 1, #factions_table do
+               local faction = factions_table[i]
+               if (comm ~= faction) and is_factions_enemies(faction, comm) and is_relation_allowed(faction , comm) then
+                       rnd_enemy[#rnd_enemy + 1] = faction
+               end
+       end
+       return (#rnd_enemy > 0) and rnd_enemy[math.random(#rnd_enemy)] or nil
 end
 
 local rnd_natural = {}
 function get_random_natural_faction(comm)
-	empty_table(rnd_natural)
-	for i = 1, #factions_table do
-		if (comm ~= factions_table[i]) and (not is_factions_enemies(factions_table[i], comm)) and is_relation_allowed(factions_table[i] , comm) then
-			rnd_natural[#rnd_natural + 1] = factions_table[i]
-		end
-	end
-	return (#rnd_natural > 0) and rnd_natural[math.random(#rnd_natural)] or nil
+       empty_table(rnd_natural)
+       for i = 1, #factions_table do
+               local faction = factions_table[i]
+               if (comm ~= faction) and (not is_factions_enemies(faction, comm)) and is_relation_allowed(faction , comm) then
+                       rnd_natural[#rnd_natural + 1] = faction
+               end
+       end
+       return (#rnd_natural > 0) and rnd_natural[math.random(#rnd_natural)] or nil
 end
 
 
@@ -560,16 +569,16 @@
 	if (USE_MARSHAL) then
 		if 	(alife_storage_manager.get_state().new_game_relations) then
 			-- Restore relations for each faction:
-			for i = 1, #factions_table do
-				for j = (i + 1), #factions_table do
-					local faction_1 = factions_table[i]
-					local faction_2 = factions_table[j]
+                       for i = 1, #factions_table do
+                               local faction_1 = factions_table[i]
+                               for j = (i + 1), #factions_table do
+                                       local faction_2 = factions_table[j]
 					
 					load_relation ( faction_1 , faction_2 ) -- load and set overall faction relations:
 					load_relation ( "actor_" .. faction_1 , faction_2 ) -- load and set actor faction 1 / faction 2 relations:
-					load_relation ( faction_1 , "actor_" .. faction_2 ) -- load and set actor faction 2 / faction 1 relations:
-				end
-			end
+                                       load_relation ( faction_1 , "actor_" .. faction_2 ) -- load and set actor faction 2 / faction 1 relations:
+                               end
+                       end
 		else
 			reset_all_relations()
 			alife_storage_manager.get_state().new_game_relations = true
@@ -925,15 +934,16 @@
 	if (not rank_relation) then
 		rank_relation = {}
 		
-		local rn = utils_obj.get_rank_list()
-		for i=1,#rn do
-			rank_relation[rn[i]] = {}
-			local t = parse_list(ini_sys,"rank_relations",rn[i])
-			for j,num in ipairs(t) do
-				rank_relation[rn[i]][rn[j]] = tonumber(num)
-				--printf("-rank [%s][%s] = %s", rn[i], rn[j], tonumber(num))
-			end
-		end
+               local rn = utils_obj.get_rank_list()
+               for i=1,#rn do
+                       local rank = rn[i]
+                       rank_relation[rank] = {}
+                       local t = parse_list(ini_sys,"rank_relations",rank)
+                       for j,num in ipairs(t) do
+                               rank_relation[rank][rn[j]] = tonumber(num)
+                                --printf("-rank [%s][%s] = %s", rn[i], rn[j], tonumber(num))
+                       end
+               end
 	end
 	
 	local rank_1 = ranks.get_obj_rank_name(obj_1)
@@ -947,15 +957,16 @@
 	if (not reputation_relation) then
 		reputation_relation = {}
 		
-		local rn = utils_obj.get_reputation_list()
-		for i=1,#rn do
-			reputation_relation[rn[i]] = {}
-			local t = parse_list(ini_sys,"reputation_relations",rn[i])
-			for j,num in ipairs(t) do
-				reputation_relation[rn[i]][rn[j]] = tonumber(num)
-				--printf("-rep [%s][%s] = %s", rn[i], rn[j], tonumber(num))
-			end
-		end
+               local rn = utils_obj.get_reputation_list()
+               for i=1,#rn do
+                       local rep = rn[i]
+                       reputation_relation[rep] = {}
+                       local t = parse_list(ini_sys,"reputation_relations",rep)
+                       for j,num in ipairs(t) do
+                               reputation_relation[rep][rn[j]] = tonumber(num)
+                               --printf("-rep [%s][%s] = %s", rn[i], rn[j], tonumber(num))
+                       end
+               end
 	end
 	
 	local rep_1 = utils_obj.get_reputation_name(obj_1:character_reputation())
```
</details>
| game_setup.script | - | - | missing in gamma |
| game_statistics.script | - | - | missing in gamma |
| gameplay_disguise.script | - | - | missing in gamma |
| gameplay_peace_zone.script | - | - | missing in gamma |
| gamma_dynamic_radiation_areas_from_arzsi.script | - | - | missing in gamma |
| grok_actor_damage_balancer.script | - | - | missing in gamma |
| grok_additional_storyline_npc_invincible.script | - | - | missing in gamma |
| grok_armor_convert.script | - | - | missing in gamma |
| grok_armor_trade.script | - | - | missing in gamma |
| grok_artefacts_bip.script | - | - | missing in gamma |
| grok_artefacts_bip_mcm.script | - | - | missing in gamma |
| grok_artefacts_melter.script | - | - | missing in gamma |
| grok_artefacts_melter_charge.script | - | - | missing in gamma |
| grok_artefacts_random_condition.script | - | - | missing in gamma |
| grok_artefacts_random_spawner.script | - | - | missing in gamma |
| grok_bleed_icon.script | - | - | missing in gamma |
| grok_bo.script | - | - | missing in gamma |
| grok_bo_eft_hit_effects.script | - | - | missing in gamma |
| grok_bo_enhanced_recoil.script | - | - | missing in gamma |
| grok_casings_sounds.script | - | - | missing in gamma |
| grok_casings_sounds_mcm.script | - | - | missing in gamma |
| grok_companions_no_ammo.script | - | - | missing in gamma |
| grok_crooks_ui_data_remover.script | - | - | missing in gamma |
| grok_dnpcav_base_move_monkey_patch.script | - | - | missing in gamma |
| grok_dof_with_UI.script | - | - | missing in gamma |
| grok_doom_weapons_inspect.script | - | - | missing in gamma |
| grok_drop_item_press_key_mcm.script | - | - | missing in gamma |
| grok_dynamic_despawner.script | - | - | missing in gamma |
| grok_dynamic_despawner_mcm.script | - | - | missing in gamma |
| grok_fov_tricks_saver_mcm.script | - | - | missing in gamma |
| grok_gamma_manual_on_startup.script | - | - | missing in gamma |
| grok_get_companions.script | - | - | missing in gamma |
| grok_gotta_go_fast.script | - | - | missing in gamma |
| grok_gotta_go_fast_mcm.script | - | - | missing in gamma |
| grok_gun_condition_fixed.script | - | - | missing in gamma |
| grok_gun_kit_condition_nerfer.script | - | - | missing in gamma |
| grok_gun_no_condition_text.script | - | - | missing in gamma |
| grok_killing_friends_reduces_goodwill.script | - | - | missing in gamma |
| grok_loot_claim.script | - | - | missing in gamma |
| grok_masks_reflections.script | - | - | missing in gamma |
| grok_navs_masks_enabler.script | - | - | missing in gamma |
| grok_nes.script | - | - | missing in gamma |
| grok_no_north_faction_in_south.script | - | - | missing in gamma |
| grok_no_npc_friendly_fire.script | - | - | missing in gamma |
| grok_progressive_rad_damages.script | - | - | missing in gamma |
| grok_psy_fields_in_the_north.script | - | - | missing in gamma |
| grok_remove_belt_duplicates.script | - | - | missing in gamma |
| grok_remove_knife_ammo_on_start.script | - | - | missing in gamma |
| grok_sin_allied_to_mutants.script | - | - | missing in gamma |
| grok_sniper_remover.script | - | - | missing in gamma |
| grok_spawn_lights.script | - | - | missing in gamma |
| grok_stashes_on_corpses.script | - | - | missing in gamma |
| grok_vehicles_spawner.script | - | - | missing in gamma |
| ground_coffee.script | - | - | missing in gamma |
| guards_spawner.script | - | - | missing in gamma |
| guitar_anim.script | - | - | missing in gamma |
| gunslinger_controller.script | - | - | missing in gamma |
| half_damage.script | - | - | missing in gamma |
| harmonica_anim.script | - | - | missing in gamma |
| haru_arm.script | - | - | missing in gamma |
| haru_quick_action_wheel_mcm.script | - | - | missing in gamma |
| haru_skills.script | - | - | missing in gamma |
| haru_skills_mcm.script | - | - | missing in gamma |
| haru_specialized_storage_boxes.script | - | - | missing in gamma |
| he_is_with_me.script | - | - | missing in gamma |
| headgear_animations.script | - | - | missing in gamma |
| headgear_animations_hotkey.script | - | - | missing in gamma |
| headgear_animations_mcm.script | - | - | missing in gamma |
| hf_bbox.script | - | - | missing in gamma |
| hf_bshape.script | - | - | missing in gamma |
| hf_furniture_types.script | - | - | missing in gamma |
| hf_map_objects.script | - | - | missing in gamma |
| hf_mcm.script | - | - | missing in gamma |
| hf_monkeypatches.script | - | - | missing in gamma |
| hf_obj_manager.script | - | - | missing in gamma |
| hf_placement_hud.script | - | - | missing in gamma |
| hf_version.script | - | - | missing in gamma |
| hidden_threat.script | - | - | missing in gamma |
| house_of_horrors_configs.script | - | - | missing in gamma |
| hq_coordinator.script | 11 | 0 | keep |

<details><summary>Diff for hq_coordinator.script</summary>
```diff
--- runtime files/gamedata/scripts/hq_coordinator.script
+++ gamma_walo/gamedata/scripts/hq_coordinator.script
@@ -22,6 +22,17 @@
 function coordinator.register_base(faction, base_id)
     coordinator.bases_by_faction[faction] = coordinator.bases_by_faction[faction] or {}
     table.insert(coordinator.bases_by_faction[faction], base_id)
+end
+
+--- Return an alternate base for fallback logistics.
+function coordinator.get_fallback_base(faction, exclude)
+    local bases = coordinator.bases_by_faction[faction] or {}
+    for _, id in ipairs(bases) do
+        if id ~= exclude then
+            return id
+        end
+    end
+    return nil
 end
 
 --- Schedule transports for under-supplied bases.
```
</details>
| hxf_tough_important_npcs.script | - | - | missing in gamma |
| icon_overlayer_mcm.script | - | - | missing in gamma |
| idiots_combat_assault.script | - | - | missing in gamma |
| idiots_combat_guard.script | - | - | missing in gamma |
| idiots_combat_snipe.script | - | - | missing in gamma |
| idiots_combat_support.script | - | - | missing in gamma |
| idiots_keybinds.script | - | - | missing in gamma |
| idiots_mcm.script | - | - | missing in gamma |
| idiots_surge.script | - | - | missing in gamma |
| idiots_ui.script | - | - | missing in gamma |
| igi_conditions_hf.script | - | - | missing in gamma |
| igi_hf_actions.script | - | - | missing in gamma |
| igi_rewards.script | - | - | missing in gamma |
| igi_target_repair.script | - | - | missing in gamma |
| imgui_helper.script | - | - | missing in gamma |
| immersive_skinning.script | - | - | missing in gamma |
| indirect_parts_favoriter.script | - | - | missing in gamma |
| individually_recruitable_companions.script | - | - | missing in gamma |
| instant_tooltip.script | - | - | missing in gamma |
| inventory_anti_closing.script | - | - | missing in gamma |
| inventory_upgrades_mp.script | - | - | missing in gamma |
| ish_bolt_b_gone.script | - | - | missing in gamma |
| ish_campfire_saving.script | - | - | missing in gamma |
| ish_campfire_saving_mcm.script | - | - | missing in gamma |
| ish_char_name_saves.script | - | - | missing in gamma |
| ish_fast_transfer.script | - | - | missing in gamma |
| ish_fixed_bolt_manager.script | - | - | missing in gamma |
| ish_geiger_hush.script | - | - | missing in gamma |
| ish_item_stats.script | - | - | missing in gamma |
| ish_keep_bolts.script | - | - | missing in gamma |
| ish_kill_tracker.script | - | - | missing in gamma |
| ish_proper_unload.script | - | - | missing in gamma |
| ish_read_watch.script | - | - | missing in gamma |
| ish_toggle_scope.script | - | - | missing in gamma |
| ish_toggle_scope_mcm.script | - | - | missing in gamma |
| ish_total_weights.script | - | - | missing in gamma |
| ish_ui_mutant_loot.script | - | - | missing in gamma |
| ish_xr_effects_neu.script | - | - | missing in gamma |
| item_artefact.script | - | - | missing in gamma |
| item_backpack.script | - | - | missing in gamma |
| item_cooking.script | - | - | missing in gamma |
| item_device.script | - | - | missing in gamma |
| item_exo_device.script | - | - | missing in gamma |
| item_icon_info_mcm.script | - | - | missing in gamma |
| item_knife.script | - | - | missing in gamma |
| item_milpda.script | - | - | missing in gamma |
| item_nvg.script | - | - | missing in gamma |
| item_parts.script | - | - | missing in gamma |
| item_radio.script | - | - | missing in gamma |
| item_recipe.script | - | - | missing in gamma |
| item_repair_override.script | - | - | missing in gamma |
| item_weapon.script | - | - | missing in gamma |
| itms_manager.script | - | - | missing in gamma |
| jam_animations.script | - | - | missing in gamma |
| kd_tree.script | - | - | missing in gamma |
| keep_guns_on_bodies.script | - | - | missing in gamma |
| kit_binder.script | - | - | missing in gamma |
| lam.script | - | - | missing in gamma |
| lam2.script | - | - | missing in gamma |
| lam_fov_manager.script | - | - | missing in gamma |
| larp.script | - | - | missing in gamma |
| lc_custom.script | - | - | missing in gamma |
| lc_extra_transitions.script | - | - | missing in gamma |
| lc_extra_transitions_mcm.script | - | - | missing in gamma |
| lc_extra_transitions_ui.script | - | - | missing in gamma |
| leer_fdda_redone_af_inspect.script | - | - | missing in gamma |
| legendary_squad_system.script | 0 | 0 | keep |

<details><summary>Diff for legendary_squad_system.script</summary>
```diff
```
</details>
| lewd_lens_hider.script | - | - | missing in gamma |
| light_gem_mcm.script | - | - | missing in gamma |
| liz_fdda_input_manager.script | - | - | missing in gamma |
| liz_fdda_redone_animation_mutator.script | - | - | missing in gamma |
| liz_fdda_redone_armor_plate.script | - | - | missing in gamma |
| liz_fdda_redone_auto_cancel.script | - | - | missing in gamma |
| liz_fdda_redone_backpack.script | - | - | missing in gamma |
| liz_fdda_redone_backpack_equip.script | - | - | missing in gamma |
| liz_fdda_redone_body_search.script | - | - | missing in gamma |
| liz_fdda_redone_consumables.script | - | - | missing in gamma |
| liz_fdda_redone_enjoy_cigarettes.script | - | - | missing in gamma |
| liz_fdda_redone_headgear_animations.script | - | - | missing in gamma |
| liz_fdda_redone_headgear_animations_hotkey.script | - | - | missing in gamma |
| liz_fdda_redone_item_pickup.script | - | - | missing in gamma |
| liz_fdda_redone_mcm.script | - | - | missing in gamma |
| liz_fdda_redone_mutant_skinning.script | - | - | missing in gamma |
| liz_fdda_redone_outfit.script | - | - | missing in gamma |
| liz_fdda_redone_outfit_inspect.script | - | - | missing in gamma |
| liz_fdda_redone_patch_exo_anims.script | - | - | missing in gamma |
| liz_inertia_expanded.script | - | - | missing in gamma |
| liz_inertia_expanded_crawl.script | - | - | missing in gamma |
| liz_inertia_expanded_crawl_sounds.script | - | - | missing in gamma |
| liz_inertia_expanded_crawl_state_tracker.script | - | - | missing in gamma |
| liz_inertia_expanded_custom_weapon_configs.script | - | - | missing in gamma |
| liz_inertia_expanded_mcm.script | - | - | missing in gamma |
| liz_inertia_expanded_patches.script | - | - | missing in gamma |
| loadouts_injector.script | - | - | missing in gamma |
| lower_weapon_sprint.script | - | - | missing in gamma |
| ltx_help_ex.script | - | - | missing in gamma |
| lua_help_ex.script | - | - | missing in gamma |
| lua_help_imgui.script | - | - | missing in gamma |
| m1a1_autoinject.script | - | - | missing in gamma |
| mag_support.script | - | - | missing in gamma |
| mags_patches.script | - | - | missing in gamma |
| mcm_log.script | - | - | missing in gamma |
| meat_spoiling.script | - | - | missing in gamma |
| meat_spoiling_mcm.script | - | - | missing in gamma |
| melee_trade_inject.script | - | - | missing in gamma |
| meta_overlord.script | 0 | 0 | keep |

<details><summary>Diff for meta_overlord.script</summary>
```diff
```
</details>
| mini_map_toggle_mcm.script | - | - | missing in gamma |
| mirage_configs.script | - | - | missing in gamma |
| modded_exes_migration.script | - | - | missing in gamma |
| model_dropper_mcm.script | - | - | missing in gamma |
| modxml_AL_MapSpots.script | - | - | missing in gamma |
| modxml_AL_MapSpots_219.script | - | - | missing in gamma |
| modxml_AL_MapSpots_43.script | - | - | missing in gamma |
| modxml_AL_QuestArrow.script | - | - | missing in gamma |
| modxml_AL_QuestArrow_219.script | - | - | missing in gamma |
| modxml_AL_QuestArrow_43.script | - | - | missing in gamma |
| modxml_AL_StashMarkers.script | - | - | missing in gamma |
| modxml_AL_StashMarkers_219.script | - | - | missing in gamma |
| modxml_AL_StashMarkers_43.script | - | - | missing in gamma |
| modxml_anomalous_stash.script | - | - | missing in gamma |
| modxml_aysd.script | - | - | missing in gamma |
| modxml_blackmarket.script | - | - | missing in gamma |
| modxml_blackmarket_loadoutscleaner.script | - | - | missing in gamma |
| modxml_idiots_ui.script | - | - | missing in gamma |
| modxml_individually_recruitable_companions.script | - | - | missing in gamma |
| modxml_inject_keybinds.script | - | - | missing in gamma |
| modxml_maingame_no_item_icons.script | - | - | missing in gamma |
| modxml_map_spots_milpda.script | - | - | missing in gamma |
| modxml_map_spots_paw.script | - | - | missing in gamma |
| modxml_nta.script | - | - | missing in gamma |
| modxml_saiga_fixes_merc.script | - | - | missing in gamma |
| modxml_saiga_fixes_nerd.script | - | - | missing in gamma |
| modxml_test.script | - | - | missing in gamma |
| modxml_tutorial_hooks.script | - | - | missing in gamma |
| momo_multihit_fix.script | - | - | missing in gamma |
| momopate_pba_tweaks.script | - | - | missing in gamma |
| momopate_proper_jam_chance.script | - | - | missing in gamma |
| momopate_savescummer_v2.script | - | - | missing in gamma |
| momopate_weaponstats.script | - | - | missing in gamma |
| monke_patch_ui.script | - | - | missing in gamma |
| monkey_axr_task_manager.script | - | - | missing in gamma |
| monkey_news_manager.script | - | - | missing in gamma |
| monkey_rioc.script | - | - | missing in gamma |
| monkey_tasks_multifetch.script | - | - | missing in gamma |
| monkey_tasks_recover_mutant_data.script | - | - | missing in gamma |
| monkey_tasks_smart_control.script | - | - | missing in gamma |
| monolith_ai.script | 0 | 0 | keep |

<details><summary>Diff for monolith_ai.script</summary>
```diff
```
</details>
| more_dangerous_phantoms.script | - | - | missing in gamma |
| more_measurement_task_maps_mcm.script | - | - | missing in gamma |
| move_effects.script | - | - | missing in gamma |
| msv_over_radiation_status_mcm.script | - | - | missing in gamma |
| mystery_of_the_swamps_configs.script | - | - | missing in gamma |
| new_game_loadout_injector_mcm.script | - | - | missing in gamma |
| new_name.script | - | - | missing in gamma |
| new_tasks_addon_mcm.script | - | - | missing in gamma |
| new_tasks_addon_tasks_utils.script | - | - | missing in gamma |
| night_mutants.script | - | - | missing in gamma |
| no_laser_while_ads_mcm.script | - | - | missing in gamma |
| node_system.script | 0 | 0 | keep |

<details><summary>Diff for node_system.script</summary>
```diff
```
</details>
| npc_loot_claim.script | - | - | missing in gamma |
| npe.script | - | - | missing in gamma |
| npe_actions.script | - | - | missing in gamma |
| npe_dialog.script | - | - | missing in gamma |
| npe_dialog_codec.script | - | - | missing in gamma |
| npe_dialog_tutorial.script | - | - | missing in gamma |
| npe_director.script | - | - | missing in gamma |
| npe_events.script | - | - | missing in gamma |
| npe_execution.script | - | - | missing in gamma |
| npe_fair_fast_travel_tutorials_mcm.script | - | - | missing in gamma |
| npe_gamma_tutorial_ammo_mcm.script | - | - | missing in gamma |
| npe_gamma_tutorial_artefact_mcm.script | - | - | missing in gamma |
| npe_gamma_tutorial_heal_mcm.script | - | - | missing in gamma |
| npe_gamma_tutorial_repair_mcm.script | - | - | missing in gamma |
| npe_gamma_tutorial_task_mcm.script | - | - | missing in gamma |
| npe_gamma_tutorial_vehicle_mcm.script | - | - | missing in gamma |
| npe_logging.script | - | - | missing in gamma |
| npe_logging_mcm.script | - | - | missing in gamma |
| npe_mcm.script | - | - | missing in gamma |
| npe_utils.script | - | - | missing in gamma |
| npe_welcome_mcm.script | - | - | missing in gamma |
| nta_money_rewards.script | - | - | missing in gamma |
| nta_utils.script | - | - | missing in gamma |
| operacia_monolith.script | - | - | missing in gamma |
| optimized_time_events.script | - | - | missing in gamma |
| options_builder.script | - | - | missing in gamma |
| options_modded_exes.script | - | - | missing in gamma |
| options_modded_exes_3d_ballistics.script | - | - | missing in gamma |
| options_modded_exes_3d_scopes.script | - | - | missing in gamma |
| options_modded_exes_aim.script | - | - | missing in gamma |
| options_modded_exes_camera.script | - | - | missing in gamma |
| options_modded_exes_control.script | - | - | missing in gamma |
| options_modded_exes_crash_saves.script | - | - | missing in gamma |
| options_modded_exes_crosshair.script | - | - | missing in gamma |
| options_modded_exes_debug.script | - | - | missing in gamma |
| options_modded_exes_doppler.script | - | - | missing in gamma |
| options_modded_exes_errors.script | - | - | missing in gamma |
| options_modded_exes_first_person_death.script | - | - | missing in gamma |
| options_modded_exes_gameplay.script | - | - | missing in gamma |
| options_modded_exes_hdr10.script | - | - | missing in gamma |
| options_modded_exes_keyboard.script | - | - | missing in gamma |
| options_modded_exes_logging.script | - | - | missing in gamma |
| options_modded_exes_monsters.script | - | - | missing in gamma |
| options_modded_exes_mouse.script | - | - | missing in gamma |
| options_modded_exes_optimizations.script | - | - | missing in gamma |
| options_modded_exes_particles.script | - | - | missing in gamma |
| options_modded_exes_pda.script | - | - | missing in gamma |
| options_modded_exes_saves.script | - | - | missing in gamma |
| options_modded_exes_sound.script | - | - | missing in gamma |
| options_modded_exes_sound_delay.script | - | - | missing in gamma |
| options_modded_exes_ui_hud.script | - | - | missing in gamma |
| options_modded_exes_visual.script | - | - | missing in gamma |
| options_modded_exes_wallmarks.script | - | - | missing in gamma |
| outfit_animations.script | - | - | missing in gamma |
| outfit_animations_backpack.script | - | - | missing in gamma |
| outfit_animations_gamma_patch.script | - | - | missing in gamma |
| outfit_animations_inspect.script | - | - | missing in gamma |
| outfit_animations_mcm.script | - | - | missing in gamma |
| outfit_animations_patches.script | - | - | missing in gamma |
| outfit_drop_mcm.script | - | - | missing in gamma |
| outfit_icon.script | - | - | missing in gamma |
| outfit_speed.script | - | - | missing in gamma |
| outfit_speed_mcm.script | - | - | missing in gamma |
| p90_autoinject.script | - | - | missing in gamma |
| parts_match_item.script | - | - | missing in gamma |
| patches_by_hotkey_mcm.script | - | - | missing in gamma |
| paw_mcm_ext.script | - | - | missing in gamma |
| pda.script | - | - | missing in gamma |
| pda_context_menu.script | 0 | 0 | keep |

<details><summary>Diff for pda_context_menu.script</summary>
```diff
```
</details>
| pda_inter_gui.script | - | - | missing in gamma |
| pda_inter_gui_a_raid.script | - | - | missing in gamma |
| pda_inter_gui_b_info.script | - | - | missing in gamma |
| pda_inter_gui_c_games.script | - | - | missing in gamma |
| pda_inter_gui_c_games_rogue.script | - | - | missing in gamma |
| pda_inter_gui_c_games_rogue_a_path.script | - | - | missing in gamma |
| pda_inter_gui_c_games_rogue_level_gen.script | - | - | missing in gamma |
| pda_inter_gui_c_games_rogue_objects.script | - | - | missing in gamma |
| pda_inter_gui_c_games_rogue_utils.script | - | - | missing in gamma |
| pda_inter_gui_d_trade.script | - | - | missing in gamma |
| pda_inter_gui_e_notes.script | - | - | missing in gamma |
| pda_inter_gui_f_banter.script | - | - | missing in gamma |
| pda_inter_gui_g_tasks.script | - | - | missing in gamma |
| pda_inter_inc.script | - | - | missing in gamma |
| pda_inter_mcm.script | - | - | missing in gamma |
| pda_inter_x_banter.script | - | - | missing in gamma |
| pda_inter_x_buyinfo.script | - | - | missing in gamma |
| pda_inter_x_raid.script | - | - | missing in gamma |
| pda_inter_x_tasks.script | - | - | missing in gamma |
| pda_inter_x_trade.script | - | - | missing in gamma |
| pda_taskboard_mcm.script | - | - | missing in gamma |
| pda_to_previous_weapon.script | - | - | missing in gamma |
| perk_based_artefacts.script | - | - | missing in gamma |
| perk_based_artefacts_bone_mapper.script | - | - | missing in gamma |
| perk_based_artefacts_item_properties.script | - | - | missing in gamma |
| perk_based_artefacts_mcm.script | - | - | missing in gamma |
| ph_sound.script | - | - | missing in gamma |
| placeable_furniture.script | - | - | missing in gamma |
| placeable_items_craft.script | - | - | missing in gamma |
| placeable_items_trade.script | - | - | missing in gamma |
| placeable_radio.script | - | - | missing in gamma |
| placeable_system.script | 0 | 0 | keep |

<details><summary>Diff for placeable_system.script</summary>
```diff
```
</details>
| pos_previewer_mcm.script | - | - | missing in gamma |
| ppp_fort17_autoinject.script | - | - | missing in gamma |
| psi_storm_manager.script | - | - | missing in gamma |
| psy_damage.script | - | - | missing in gamma |
| pulse_vortex_consistency_fix.script | - | - | missing in gamma |
| qcteleport_mcm.script | - | - | missing in gamma |
| quick_use_prio.script | - | - | missing in gamma |
| quickdraw.script | - | - | missing in gamma |
| rax_dynamic_custom_functor.script | - | - | missing in gamma |
| rax_icon_layers.script | - | - | missing in gamma |
| rax_persistent_highlight.script | - | - | missing in gamma |
| release_restr_in_x16.script | - | - | missing in gamma |
| reload_hint.script | - | - | missing in gamma |
| remember_outfit_belt.script | - | - | missing in gamma |
| remember_outfit_belt_mcm.script | - | - | missing in gamma |
| remove_gun_from_loadout.script | - | - | missing in gamma |
| replace_show_parts_health.script | - | - | missing in gamma |
| resource_pool.script | 0 | 0 | keep |

<details><summary>Diff for resource_pool.script</summary>
```diff
```
</details>
| resource_system.script | 0 | 0 | keep |

<details><summary>Diff for resource_system.script</summary>
```diff
```
</details>
| return_menu_music.script | - | - | missing in gamma |
| reworked_rf_receiver_mcm.script | - | - | missing in gamma |
| safe_start_mcm.script | - | - | missing in gamma |
| safer_af_crafting_mcm.script | - | - | missing in gamma |
| sassy_ithaca_trade_inject.script | - | - | missing in gamma |
| schemes_ai_gamma.script | - | - | missing in gamma |
| scopeRadii.script | - | - | missing in gamma |
| scope_fov_mcm.script | - | - | missing in gamma |
| scoping_hud_fov.script | - | - | missing in gamma |
| se_legs.script | - | - | missing in gamma |
| semiradiant_ai_mcm.script | - | - | missing in gamma |
| serious_the_job_can_wait_mcm.script | - | - | missing in gamma |
| serious_workshop_utils.script | - | - | missing in gamma |
| shotgun_reload_fix.script | - | - | missing in gamma |
| shotgun_unjam_fix.script | - | - | missing in gamma |
| sim_board.script | - | - | missing in gamma |
| sim_offline_combat.script | 24 | 20 | keep |

<details><summary>Diff for sim_offline_combat.script</summary>
```diff
--- runtime files/gamedata/scripts/sim_offline_combat.script
+++ gamma_walo/gamedata/scripts/sim_offline_combat.script
@@ -10,7 +10,8 @@
 	2021/02/04 - Vintar - removed Hybrid mode, re-enabled slider support for offline combat distance, changed ignore_list handling
 	2021/02/13 - Vintar - fixed warfare exclusions and missing monster factions related to call of pripyat allspawn mutants
 	2022/05/01 - Vintar - remove exemptions for `task_squads` and `task_giver_squads` to eliminate exempt squad buildup over time
-	2022/05/21 - Vintar - remove squad cap limitation, which wasn't correctly implemented for Warfare anyway
+        2022/05/21 - Vintar - remove squad cap limitation, which wasn't correctly implemented for Warfare anyway
+        2025/07/24 - d0pe - hardened offline combat loops
 
 	Offline Combat Simulator
 	Full simulation: When 2 enemy squads get close to each other, a battle will be simulated
@@ -104,24 +105,23 @@
 -------------------------------
 local function smart_terrain_on_update(smart)
 
-	empty_table(tbl_smart)
-	
-	for id,_ in pairs(SIMBOARD.smarts[smart.id].squads) do
-		tbl_smart[#tbl_smart+1] = id
-	end
+        empty_table(tbl_smart)
+
+       for id,_ in pairs(SIMBOARD.smarts[smart.id].squads) do
+               tbl_smart[#tbl_smart+1] = id
+       end
 	
 	if (#tbl_smart == 0) then
 		return
 	end
 	
-	shuffle_table(tbl_smart)
-	
-	local sim = alife()
-	local lid_1
-	
-	for i,id_1 in pairs(tbl_smart) do
-		local squad_1 = sim:object(id_1)
-		local section = squad_1 and squad_1:section_name()
+        shuffle_table(tbl_smart)
+
+        local sim = alife()
+
+        for _,id_1 in ipairs(tbl_smart) do
+                local squad_1 = sim:object(id_1)
+                local section = squad_1 and squad_1:section_name()
 		
 		if squad_1 and (not squad_1.online) and SIMBOARD.squads[squad_1.id] and (squad_1:npc_count() > 0)
 		then
@@ -130,8 +130,8 @@
 				return
 			end
 	
-			lid_1 = lid_1 or game_graph():vertex(squad_1.m_game_vertex_id):level_id()
-			if lid_1 and squads_by_level[lid_1] then 
+                        local lid_1 = game_graph():vertex(squad_1.m_game_vertex_id):level_id()
+                        if lid_1 and squads_by_level[lid_1] then
 				
 --				if (not task_squads[id_1]) and (not task_giver_squads[id_1]) then
 					-- disable offline combat for ignore list when Warfare is active
@@ -150,9 +150,9 @@
 							end
 						end
 				
-						-- Otherwise, scan for squads in the same map
-						for j,id_2 in pairs(tbl_smart) do
-							in_combat = validate_enemy(sim, lid_1, squad_1, id_1, id_2, community_1)
+                                                -- Otherwise, scan for squads in the same map
+                                                for _,id_2 in ipairs(tbl_smart) do
+                                                        in_combat = validate_enemy(sim, lid_1, squad_1, id_1, id_2, community_1)
 							if in_combat then
 								if enable_debug then
 									printf("% OCS | Battle in smart [%s]", smart:name())
@@ -241,7 +241,11 @@
 end
 
 local function coordinator()
-	ResetTimeEvent("cycle","ocs", UPDATE_TIME)
+       ResetTimeEvent("cycle","ocs", UPDATE_TIME)
+
+       if not (SIMBOARD and SIMBOARD.smarts) then
+               return true -- wait until SIMBOARD initialized
+       end
 	
 	-- Toggle feature
 	
```
</details>
| sim_squad_scripted.script | 1 | 1 | keep |

<details><summary>Diff for sim_squad_scripted.script</summary>
```diff
--- runtime files/gamedata/scripts/sim_squad_scripted.script
+++ gamma_walo/gamedata/scripts/sim_squad_scripted.script
@@ -136,7 +136,7 @@
 	
 	local new_id = tonumber(new_target)
 	local se_target = new_id and alife_object(new_id)
-	if se_target and (obj:clsid() == clsid.online_offline_group_s or obj:clsid() == clsid.smart_terrain) then
+	if se_target and (se_target:clsid() == clsid.online_offline_group_s or se_target:clsid() == clsid.smart_terrain) then
 		return new_id
 	end
 end
```
</details>
| sim_squad_warfare.script | 2 | 1 | keep |

<details><summary>Diff for sim_squad_warfare.script</summary>
```diff
--- runtime files/gamedata/scripts/sim_squad_warfare.script
+++ gamma_walo/gamedata/scripts/sim_squad_warfare.script
@@ -6,7 +6,8 @@
 	2020/09/22 - Vintar - loners no longer see other loner squads outside of fog of war (without PDA v2 or v3)
 	2021/02/13 - Vintar - added toggle capability for loner fog of war
 	2021/02/18 - Vintar - friendly random patrol squads are now labeled
-	2021/11/09 - Vintar - added goodwill on kill functionality
+        2021/11/09 - Vintar - added goodwill on kill functionality
+        2025/07/24 - d0pe - synced with modular warfare system
 
 	This file contains mostly retired functions, but still handles some squad-level stuff 
 	such as PDA squad spots and Warfare squad registration
```
</details>
| simulation_objects.script | - | - | missing in gamma |
| slaxml.script | - | - | missing in gamma |
| smart_terrain.script | - | - | missing in gamma |
| smart_terrain_warfare.script | 12 | 10 | keep |

<details><summary>Diff for smart_terrain_warfare.script</summary>
```diff
--- runtime files/gamedata/scripts/smart_terrain_warfare.script
+++ gamma_walo/gamedata/scripts/smart_terrain_warfare.script
@@ -26,7 +26,8 @@
 	2022/03/06 - Vintar - monster spawn numbers based on level lair capacity
 	2022/04/15 - Ace - Fix for crash when dead allied defenders try to send a message after invasion force is defeated
 	2022/04/22 - Vintar - Mutants from X8 and Pripyat Underpass can no longer transition out
-	2022/04/30 - Vintar - Main base attack prevention also applies to mutants
+        2022/04/30 - Vintar - Main base attack prevention also applies to mutants
+        2025/07/24 - d0pe - added nil checks for target selection
 	
 	This file handles the majority of warfare-related script tasks, such as squad behavior,
 	targeting, smart terrain updates, ownership checks, patrol behavior, etc.
@@ -1121,9 +1122,10 @@
 	if ((pda_actor.manual_control and smart.owning_faction ~= warfare.actor_faction) or (not pda_actor.manual_control)) then
 		local targets = find_targets(smart)
 			
-		if (#targets > 0) then
-			for i=1,#targets do
-				if not (smart.target_smarts[targets[i][2]]) then
+               if (#targets > 0) then
+                       for i=1,#targets do
+                               local target = targets[i]
+                               if not (smart.target_smarts[target[2]]) then
 					local target_delta = target_smart_count - invading_faction_props.min_smart_targets_per_base
 					if (target_delta < 0) then
 						local other = alife_object(targets[i][2])
@@ -4378,9 +4380,9 @@
 	local targets = {}
 	local mainbase_targets = {}  -- backup array if targets array is empty
 	
-	if (faction == "monster") then
-		return
-	end
+       if (faction == "monster") then
+               return {}
+       end
 	
 	for i=1,#smartCollection do
 		-- Do not even factor in which level this base is on. We want to have fluid borders at this point.
@@ -4600,9 +4602,9 @@
 		end
 	end
 
-	if (faction == "monster") then
-		return
-	end
+       if (faction == "monster") then
+               return {}
+       end
 
 	for i=1,#smartCollection do
 		local other = smartCollection[i] and alife_object(smartCollection[i])		
```
</details>
| smooth_prog_mcm.script | - | - | missing in gamma |
| smr_amain_mcm.script | - | - | missing in gamma |
| smr_anomalies_mcm.script | - | - | missing in gamma |
| smr_civil_war.script | - | - | missing in gamma |
| smr_config.script | - | - | missing in gamma |
| smr_debug.script | - | - | missing in gamma |
| smr_loot.script | - | - | missing in gamma |
| smr_loot_mcm.script | - | - | missing in gamma |
| smr_mutants_mcm.script | - | - | missing in gamma |
| smr_pop.script | - | - | missing in gamma |
| smr_spawns_mcm.script | - | - | missing in gamma |
| smr_stalkers_mcm.script | - | - | missing in gamma |
| smr_zombies_mcm.script | - | - | missing in gamma |
| smr_zzintegration_mcm.script | - | - | missing in gamma |
| soul_anim_mutators.script | - | - | missing in gamma |
| soulslike.script | - | - | missing in gamma |
| soulslike_classes.script | - | - | missing in gamma |
| soulslike_mcm.script | - | - | missing in gamma |
| soulslike_message_factory.script | - | - | missing in gamma |
| soulslike_note.script | - | - | missing in gamma |
| soulslike_scenario_logic_factory.script | - | - | missing in gamma |
| soulslike_scenarios.script | - | - | missing in gamma |
| soulslike_sleep_dialog.script | - | - | missing in gamma |
| souslike_gamemode_injector_mcm.script | - | - | missing in gamma |
| speed.script | - | - | missing in gamma |
| squad_gear_scaler.script | 0 | 0 | keep |

<details><summary>Diff for squad_gear_scaler.script</summary>
```diff
```
</details>
| squad_spawn_system.script | 0 | 0 | keep |

<details><summary>Diff for squad_spawn_system.script</summary>
```diff
```
</details>
| squad_transport.script | 40 | 3 | keep |

<details><summary>Diff for squad_transport.script</summary>
```diff
--- runtime files/gamedata/scripts/squad_transport.script
+++ gamma_walo/gamedata/scripts/squad_transport.script
@@ -3,16 +3,22 @@
     ----------------------
     Assigns resource cargo to squad members and handles transfers or
     losses. Each stalker carries one unit of the requested resource.
-    Last edit: 2025-07-25
+    Last edit: 2025-08-30
+    -- Modified by Codex: Implement Squad Loot Recovery
 ]]
 
 local transport = {}
+local hq_module = require 'hq_coordinator'
+transport.hq = hq_module
 
 --- Create a transport descriptor from a HQ task.
 function transport.create(task)
-    local squad = {from=task.from, to=task.to, resource=task.resource, cargo=task.amount, members={}}
+    local squad = {from=task.from, to=task.to, faction=task.faction, resource=task.resource, cargo=task.amount, members={}}
     for i=1, task.amount do
-        table.insert(squad.members, {carrying=task.resource})
+        -- each member stores carried resource for loot recovery
+        local mem = {carrying=task.resource}
+        mem.squad = squad
+        table.insert(squad.members, mem)
     end
     return squad
 end
@@ -25,4 +31,35 @@
     return dropped
 end
 
+--- Choose an alternate base destination for the squad.
+local function pick_fallback_base(faction, exclude)
+    local hq = transport.hq or hq_module
+    if hq.get_fallback_base then
+        return hq.get_fallback_base(faction, exclude)
+    end
+    local bases = hq.bases_by_faction[faction] or {}
+    for _, id in ipairs(bases) do
+        if id ~= exclude then
+            return id
+        end
+    end
+    return nil
+end
+
+--- Reroute a transport squad to a safe base.
+function transport.reroute(squad)
+    if not squad or not squad.faction then return end
+    local new_to = pick_fallback_base(squad.faction, squad.to)
+    if new_to then
+        squad.to = new_to
+        return true
+    end
+    return false
+end
+
+--- Mark squad in danger and trigger reroute.
+function transport.mark_danger(squad)
+    return transport.reroute(squad)
+end
+
 return transport
```
</details>
| sr_camp.script | - | - | missing in gamma |
| sr_light.script | - | - | missing in gamma |
| sr_psy_antenna.script | - | - | missing in gamma |
| ssfx_001_mcm.script | - | - | missing in gamma |
| ssfx_001_settings.script | - | - | missing in gamma |
| ssfx_ao.script | - | - | missing in gamma |
| ssfx_ao_mcm.script | - | - | missing in gamma |
| ssfx_ao_settings.script | - | - | missing in gamma |
| ssfx_florafixes.script | - | - | missing in gamma |
| ssfx_florafixes_mcm.script | - | - | missing in gamma |
| ssfx_florafixes_settings.script | - | - | missing in gamma |
| ssfx_fog.script | - | - | missing in gamma |
| ssfx_fog_mcm.script | - | - | missing in gamma |
| ssfx_fog_settings.script | - | - | missing in gamma |
| ssfx_il.script | - | - | missing in gamma |
| ssfx_il_mcm.script | - | - | missing in gamma |
| ssfx_il_settings.script | - | - | missing in gamma |
| ssfx_interactive_grass.script | - | - | missing in gamma |
| ssfx_interactive_grass_mcm.script | - | - | missing in gamma |
| ssfx_interactive_grass_settings.script | - | - | missing in gamma |
| ssfx_lut.script | - | - | missing in gamma |
| ssfx_parallax.script | - | - | missing in gamma |
| ssfx_parallax_mcm.script | - | - | missing in gamma |
| ssfx_parallax_settings.script | - | - | missing in gamma |
| ssfx_pp_0taa.script | - | - | missing in gamma |
| ssfx_pp_0taa_settings.script | - | - | missing in gamma |
| ssfx_pp_bloom.script | - | - | missing in gamma |
| ssfx_pp_bloom_settings.script | - | - | missing in gamma |
| ssfx_pp_mblur.script | - | - | missing in gamma |
| ssfx_pp_mblur_settings.script | - | - | missing in gamma |
| ssfx_pp_mcm.script | - | - | missing in gamma |
| ssfx_rain.script | - | - | missing in gamma |
| ssfx_rain_footsteps.script | - | - | missing in gamma |
| ssfx_rain_footsteps_settings.script | - | - | missing in gamma |
| ssfx_rain_hud_raindrops.script | - | - | missing in gamma |
| ssfx_rain_hud_raindrops_settings.script | - | - | missing in gamma |
| ssfx_rain_mcm.script | - | - | missing in gamma |
| ssfx_rain_settings.script | - | - | missing in gamma |
| ssfx_shadow_cascades.script | - | - | missing in gamma |
| ssfx_shadow_cascades_mcm.script | - | - | missing in gamma |
| ssfx_shadow_cascades_settings.script | - | - | missing in gamma |
| ssfx_shadows.script | - | - | missing in gamma |
| ssfx_shadows_mcm.script | - | - | missing in gamma |
| ssfx_shadows_settings.script | - | - | missing in gamma |
| ssfx_ssr.script | - | - | missing in gamma |
| ssfx_ssr_mcm.script | - | - | missing in gamma |
| ssfx_ssr_settings.script | - | - | missing in gamma |
| ssfx_sss.script | - | - | missing in gamma |
| ssfx_sss_mcm.script | - | - | missing in gamma |
| ssfx_sss_settings.script | - | - | missing in gamma |
| ssfx_terrain.script | - | - | missing in gamma |
| ssfx_terrain_mcm.script | - | - | missing in gamma |
| ssfx_terrain_parallax.script | - | - | missing in gamma |
| ssfx_terrain_settings.script | - | - | missing in gamma |
| ssfx_underground_check.script | - | - | missing in gamma |
| ssfx_water.script | - | - | missing in gamma |
| ssfx_water_mcm.script | - | - | missing in gamma |
| ssfx_water_settings.script | - | - | missing in gamma |
| ssfx_weapons_dof.script | - | - | missing in gamma |
| ssfx_weapons_dof_mcm.script | - | - | missing in gamma |
| ssfx_weapons_dof_settings.script | - | - | missing in gamma |
| ssfx_wetness.script | - | - | missing in gamma |
| ssfx_wetness_mcm.script | - | - | missing in gamma |
| ssfx_wetness_settings.script | - | - | missing in gamma |
| ssfx_wind.script | - | - | missing in gamma |
| ssfx_wind_mcm.script | - | - | missing in gamma |
| ssfx_wind_settings.script | - | - | missing in gamma |
| stacks_to_uses.script | - | - | missing in gamma |
| stalker_cloning_utility.script | - | - | missing in gamma |
| stash_capacities.script | - | - | missing in gamma |
| state_mgr_animation_list_animpoint.script | - | - | missing in gamma |
| status_icons_always_shown.script | - | - | missing in gamma |
| stealth_kill_detection.script | - | - | missing in gamma |
| stealth_mcm.script | - | - | missing in gamma |
| subtitles.script | - | - | missing in gamma |
| subtitles_mcm.script | - | - | missing in gamma |
| subtitles_ui.script | - | - | missing in gamma |
| subtitles_utils.script | - | - | missing in gamma |
| surge_manager.script | - | - | missing in gamma |
| surge_manager_faster_emissions.script | - | - | missing in gamma |
| surge_manager_ignore_npc.script | - | - | missing in gamma |
| surge_manager_tb_covers.script | - | - | missing in gamma |
| surge_rush_scheme_common.script | - | - | missing in gamma |
| surge_rush_scheme_evaluator_inside.script | - | - | missing in gamma |
| surge_rush_scheme_evaluator_outside.script | - | - | missing in gamma |
| svu_custom_inspects.script | - | - | missing in gamma |
| swm_legs.script | - | - | missing in gamma |
| swm_legs_mcm.script | - | - | missing in gamma |
| take_item_anim.script | - | - | missing in gamma |
| target_prior.script | - | - | missing in gamma |
| task_functor_hidden_threat.script | - | - | missing in gamma |
| tasks_agent_rescue.script | - | - | missing in gamma |
| tasks_assault.script | 72 | 51 | keep |

<details><summary>Diff for tasks_assault.script</summary>
```diff
--- runtime files/gamedata/scripts/tasks_assault.script
+++ gamma_walo/gamedata/scripts/tasks_assault.script
@@ -1,6 +1,10 @@
 --[[
 - Remade by Tronex
 - 2019/4/23
+
+	Edit Log:
+	2020/5/29 - Vintar - added Warfare compatibility
+	
 - Global functions for assault tasks, with support for pre-info before accepting
 	
 	Parameters for precondition
@@ -71,6 +75,7 @@
 
 
 ---------------------------< Utility >---------------------------
+-- Verify squad section name is not a low-tier mutant used for tasks
 function is_legit_mutant_squad(squad)
 	local section = squad and squad:section_name()
 	return squad and (not sfind(section,"tushkano")) and (not sfind(section,"rat")) and true or false
@@ -97,15 +102,17 @@
 	for sq_id,_ in pairs(smrt.squads) do
 		--printf("# %s | found squad (%s) in smart: %s", task_id, sq_id, smrt_name)
 		
+		-- if warfare, override checks on stay time, default squad stuff
 		-- if smart's squad is on its level + they are targeting it
 		local squad = alife_object(sq_id)
 		if squad and simulation_objects.is_on_the_same_level(squad, smart)
 		and squad.current_target_id and (squad.current_target_id == smrt_id)
 		and (squad.current_action == 1)
-		and (squad:npc_count() >= squad_def.num)
+		and (((squad:npc_count() >= squad_def.num)
 		and squad.stay_time
 		and ((not squad_def.stay_time) or (squad_def.stay_time and (game.get_game_time():diffSec(squad.stay_time) <= tonumber(squad_def.stay_time))))
-		and (squad_def.scripted or (not squad:get_script_target()))
+		and (squad_def.scripted or (not squad:get_script_target())))
+		or (_G.WARFARE and not squad:get_script_target()))
 		then
 			--printf("# %s | smart (%s) [%s] w/ squad (%s) [%s] = Checking", task_id, smrt_id, smrt_name, sq_id, squad.player_id)
 			
@@ -133,15 +140,15 @@
 		and (squad.current_target_id and squad.current_target_id == smart.id and squad.current_action == 1) 
 		then
 			--printf("- %s | squad (%s) [%s] is targeting smart (%s)", task_id, squad.id, squad.player_id, smart.id)
-			for i = 1, #cache_assault_func[task_id] do
-				local fac = cache_assault_func[task_id][i]
-				if (is_legit_mutant_squad(squad) and squad.player_id == fac) then
+                       for i = 1, #cache_assault_func[task_id] do
+                               local fac = cache_assault_func[task_id][i]
+                               if (is_legit_mutant_squad(squad) and squad.player_id == fac) then
 					-- updating data
 					var.squad_id = squad.id
 					save_var( db.actor, task_id, var )
 					
 					-- reset gametime so they don't leave
-					squad.stay_time = game.get_game_time() 
+                                        squad.stay_time = game.get_game_time()
 					squad.force_online = true
 					--printf("- %s | squad (%s) [%s] is saved", task_id, squad.id, squad.player_id)
 					return true
@@ -273,22 +280,25 @@
 	if (not cache_assault_func[task_id]) then
 		cache_assault_func[task_id] = {}
 		local params = parse_list(task_manager.task_ini,task_id,"status_functor_params")
-		if var.is_enemy then
-			for i=1,#params do
-				if is_squad_monster[params[i]] or factions_list[params[i]] then
-					cache_assault_func[task_id][i] = params[i]
-					printf("/ %s | Faction [%s] is re-added to cache_assault_func table", task_id, params[i])
-				end
-			end
+               if var.is_enemy then
+                       for i=1,#params do
+                               local param = params[i]
+                               if is_squad_monster[param] or factions_list[param] then
+                                       local idx = #cache_assault_func[task_id] + 1
+                                       cache_assault_func[task_id][idx] = param
+                                        printf("/ %s | Faction [%s] is re-added to cache_assault_func table", task_id, param)
+                                end
+                        end
 		elseif (not is_squad_monster[params[1]]) then
-			for fac,_ in pairs(factions_list) do
-				local cnt = 0
-				local is_enemy_to_actor = true --game_relations.is_factions_enemies(fac, get_actor_true_community())
-				for i=1,#params do
-					if (fac ~= params[i]) and is_enemy_to_actor and game_relations.is_factions_enemies(fac, params[i]) then
-						cnt = cnt + 1
-					end
-				end
+                       for fac,_ in pairs(factions_list) do
+                               local cnt = 0
+                               local is_enemy_to_actor = true --game_relations.is_factions_enemies(fac, get_actor_true_community())
+                               for i=1,#params do
+                                       local param = params[i]
+                                       if (fac ~= param) and is_enemy_to_actor and game_relations.is_factions_enemies(fac, param) then
+                                               cnt = cnt + 1
+                                       end
+                                end
 				if (cnt == #params) then
 					local idx = #cache_assault_func[task_id] + 1
 					cache_assault_func[task_id][idx] = fac
@@ -298,6 +308,10 @@
 		end
 		if (#cache_assault_func[task_id] == 0) then
 			printe("! %s | no enemy factions found",task_id)
+--[[
+        SERIOUS NO NORTH TASKS BEFORE BS
+        AND THE NORTHERN JOB
+--]]
 			return "fail"
 		end
 	end
@@ -393,23 +407,25 @@
 	
 	--// Collect enemy factions
 	if def.is_enemy then -- if faction parameters are enemies
-		for i=1,#p_status do
-			if is_squad_monster[p_status[i]] or factions_list[p_status[i]] then
-				--printf("/ %s | Faction [%s] is added to enemy_faction_list table", task_id, p_status[i])
-				enemy_faction_list[p_status[i]] = true
-			end
-		end
+               for i=1,#p_status do
+                       local status = p_status[i]
+                       if is_squad_monster[status] or factions_list[status] then
+                               --printf("/ %s | Faction [%s] is added to enemy_faction_list table", task_id, status)
+                               enemy_faction_list[status] = true
+                       end
+               end
 		
 	elseif (not is_squad_monster[p_status[1]]) then -- if faction parameters are matutal factions
 		for fac,_ in pairs(factions_list) do
 			local cnt = 0
 			local is_enemy_to_actor = true --game_relations.is_factions_enemies(fac, get_actor_true_community())
-			for i=1,#p_status do
-				if (fac ~= p_status[i]) and is_enemy_to_actor and game_relations.is_factions_enemies(fac, p_status[i]) then
-					cnt = cnt + 1
-				end
-			end
-			if (cnt == #p_status) then
+               for i=1,#p_status do
+                       local status = p_status[i]
+                               if (fac ~= status) and is_enemy_to_actor and game_relations.is_factions_enemies(fac, status) then
+                                       cnt = cnt + 1
+                               end
+                       end
+                        if (cnt == #p_status) then
 				enemy_faction_list[fac] = true
 				--printf("/ %s | Faction [%s] is added to enemy_faction_list table", task_id, fac)
 			end
@@ -418,30 +434,30 @@
 	
 	if is_empty(enemy_faction_list) then
 		printe("! %s | no enemy factions found", task_id)
+--[[
+        SERIOUS NO NORTH TASKS BEFORE BS
+        AND THE NORTHERN JOB
+--]]
+        local additionalBlacklist = {}
+        local mcm_scanMode = blacklist_helper.GetMcmDropdownValue()
+        local northernMaps = blacklist_helper.GetNorthernMaps()
+
+        if mcm_scanMode and mcm_scanMode > 0  then
+                def.scan = mcm_scanMode
+        end
+
+        if blacklist_helper.ShouldBlacklistNorth() then
+                additionalBlacklist = northernMaps
+        elseif northernMaps[level.name()] then -- Player is in the Northern region and rightfully so
+                additionalBlacklist = blacklist_helper.GetSouthernMaps()
+        end
+--[[
+        SERIOUS NO NORTH TASKS BEFORE BS
+        AND THE NORTHERN JOB
+--]]
 		return false
 	end
 	
---[[
-	SERIOUS NO NORTH TASKS BEFORE BS
-	AND THE NORTHERN JOB
---]]
-	local additionalBlacklist = {}
-	local mcm_scanMode = blacklist_helper.GetMcmDropdownValue()
-	local northernMaps = blacklist_helper.GetNorthernMaps()
-
-	if mcm_scanMode and mcm_scanMode > 0  then
-		def.scan = mcm_scanMode
-	end
-
-	if blacklist_helper.ShouldBlacklistNorth() then
-		additionalBlacklist = northernMaps
-	elseif northernMaps[level.name()] then -- Player is in the Northern region and rightfully so
-		additionalBlacklist = blacklist_helper.GetSouthernMaps()
-	end
---[[
-	SERIOUS NO NORTH TASKS BEFORE BS
-	AND THE NORTHERN JOB
---]]
 	
 	--// Search all smarts
 	local targets = {} -- target[squad_id] = smart_id
@@ -459,7 +475,8 @@
 			
 				-- if smart is not in blacklisted location
 				local smart_level = sim:level_name(gg:vertex(v.m_game_vertex_id):level_id())
-				if (not blacklisted_maps[smart_level] and not additionalBlacklist[smart_level]) then
+				if (not blacklisted_maps[smart_level]) then
+				
 					-- if smart location is proper to the parameter
 					local is_online = v.online
 					local is_nearby = sfind(simulation_objects.config:r_value(actor_level, "target_maps", 0, ""), smart_level)
```
</details>
| tasks_baba_yaga.script | - | - | missing in gamma |
| tasks_big_game.script | - | - | missing in gamma |
| tasks_bounty.script | - | - | missing in gamma |
| tasks_brain_game.script | - | - | missing in gamma |
| tasks_chimera_scan.script | - | - | missing in gamma |
| tasks_dead_night.script | - | - | missing in gamma |
| tasks_defense.script | 4 | 2 | keep |

<details><summary>Diff for tasks_defense.script</summary>
```diff
--- runtime files/gamedata/scripts/tasks_defense.script
+++ gamma_walo/gamedata/scripts/tasks_defense.script
@@ -1,3 +1,5 @@
+-- Modified by Codex: Crashlog Fix - tasks_defense.script (2025-07-25)
+-- Replaced game_relations.is_factions_enemies with global is_factions_enemies to avoid nil call
 
 -- =======================================================================================
 -- Created by tdef
@@ -169,7 +171,7 @@
 				se_obj and 
 				IsStalker(nil, se_obj:clsid()) and 
 				se_obj:alive() and 
-				not game_relations.is_factions_enemies(se_obj:community(),"freedom") and 
+				not is_factions_enemies(se_obj:community(),"freedom") and 
 				string.find(se_obj:name(),'default') and
 				not (se_obj:community() == 'bandit') and
 				not (se_obj:community() == 'trader')
@@ -239,7 +241,7 @@
 	-- printl('barrier_defense_available(%s) AAA',tid)
 	-- dont trigger if hostile to freedom
 	-- should check vs default_comm in gameplay_disguise but what if disguise is disabled? it it nil? or what?
-	if game_relations.is_factions_enemies(character_community(db.actor),"freedom") then return false end
+	if is_factions_enemies(character_community(db.actor),"freedom") then return false end
 	
 	if not MDATA then return false end
 	-- printl('barrier_defense_available(%s) BBB',tid)
```
</details>
| tasks_delivery.script | - | - | missing in gamma |
| tasks_dominance.script | - | - | missing in gamma |
| tasks_fate.script | - | - | missing in gamma |
| tasks_fetch.script | - | - | missing in gamma |
| tasks_gambling_with_life.script | - | - | missing in gamma |
| tasks_guide.script | - | - | missing in gamma |
| tasks_hold_the_ground.script | - | - | missing in gamma |
| tasks_house_of_horrors.script | - | - | missing in gamma |
| tasks_intercept_artifact.script | - | - | missing in gamma |
| tasks_measure.script | - | - | missing in gamma |
| tasks_mirage.script | - | - | missing in gamma |
| tasks_mystery_of_the_swamps.script | - | - | missing in gamma |
| tasks_no_step_back.script | - | - | missing in gamma |
| tasks_nta_stash.script | - | - | missing in gamma |
| tasks_placeable_waypoints.script | - | - | missing in gamma |
| tasks_pump_station_defense.script | - | - | missing in gamma |
| tasks_skyfall.script | - | - | missing in gamma |
| tasks_smart_control.script | 1 | 0 | keep |

<details><summary>Diff for tasks_smart_control.script</summary>
```diff
--- runtime files/gamedata/scripts/tasks_smart_control.script
+++ gamma_walo/gamedata/scripts/tasks_smart_control.script
@@ -52,6 +52,7 @@
 }
 
 ---------------------------< Utility >---------------------------
+-- Check squad section name is valid for smart control tasks
 function is_legit_mutant_squad(squad)
 	local section = squad and squad:section_name()
 	return squad and (not sfind(section,"tushkano")) and (not sfind(section,"rat")) and true or false
```
</details>
| tasks_stash.script | - | - | missing in gamma |
| tasks_the_living_fire.script | - | - | missing in gamma |
| tasks_urgent_orders.script | - | - | missing in gamma |
| tasks_vengence_amplified.script | - | - | missing in gamma |
| tb_new_stashes.script | - | - | missing in gamma |
| tb_remove_the_tiny_cubes.script | - | - | missing in gamma |
| test_npe_execution_client.script | - | - | missing in gamma |
| thirst_sleep_changer.script | - | - | missing in gamma |
| tmp9.script | - | - | missing in gamma |
| tpa_patch_repairs.script | - | - | missing in gamma |
| trader_autoinject.script | - | - | missing in gamma |
| trans_outfit.script | - | - | missing in gamma |
| treasure_manager.script | - | - | missing in gamma |
| true_first_person_death.script | - | - | missing in gamma |
| txr_routes.script | - | - | missing in gamma |
| ui_addon_companion_quick_menu.script | - | - | missing in gamma |
| ui_debug_launcher.script | - | - | missing in gamma |
| ui_debug_weather.script | - | - | missing in gamma |
| ui_dosimeter.script | - | - | missing in gamma |
| ui_furniture_light.script | - | - | missing in gamma |
| ui_furniture_piano.script | - | - | missing in gamma |
| ui_furniture_workshop.script | - | - | missing in gamma |
| ui_haru_skills.script | - | - | missing in gamma |
| ui_hud_dotmarks.script | - | - | missing in gamma |
| ui_inventory.script | - | - | missing in gamma |
| ui_item.script | - | - | missing in gamma |
| ui_main_menu.script | - | - | missing in gamma |
| ui_mcm.script | - | - | missing in gamma |
| ui_mcm_argb_input.script | - | - | missing in gamma |
| ui_minimap_counter.script | - | - | missing in gamma |
| ui_mm_faction_select.script | 0 | 0 | keep |

<details><summary>Diff for ui_mm_faction_select.script</summary>
```diff
```
</details>
| ui_mod_elements.script | - | - | missing in gamma |
| ui_mod_elements_mcm.script | - | - | missing in gamma |
| ui_mutant_loot.script | - | - | missing in gamma |
| ui_options.script | 6 | 5 | keep |

<details><summary>Diff for ui_options.script</summary>
```diff
--- runtime files/gamedata/scripts/ui_options.script
+++ gamma_walo/gamedata/scripts/ui_options.script
@@ -26,7 +26,8 @@
 	2020/11/07 - Vintar - added resurgence chance as option
 	2021/02/13 - Vintar - added 'overflow overrides manual control' and 'extra loner fog of war' toggle, min smart targets per base
 	2021/11/09 - Vintar - added goodwill on kill options, added back "hide all smarts" option, added 'old autocapture' option
-	2022/02/26 - Vintar - added main base attack deprioritization option
+        2022/02/26 - Vintar - added main base attack deprioritization option
+        2025/07/24 - d0pe - minor formatting cleanup
 	
 --]]
 
@@ -124,7 +125,7 @@
 		{ id= "texture_lod"            ,type= "track"    ,val= 2	,cmd= "texture_lod"	                ,min= 0     ,max= 4     ,step= 1 	,no_str= true	  ,invert= true     ,vid= true	,restart= true	},
 		{ id= "geometry_lod"           ,type= "track"    ,val= 2	,cmd= "r__geometry_lod"	            ,min= 0.1   ,max= 1.5   ,step= 0.1 },
 		{ id= "mipbias"           	   ,type= "track"    ,val= 2	,cmd= "r__tf_mipbias"	            ,min= -0.5  ,max= 0.5   ,step= 0.1 	,no_str= true 	  ,invert= true },
-		{ id= "tf_aniso"               ,type= "track"    ,val= 2	,cmd= "r__tf_aniso"	                ,min= 1     ,max= 16    ,step= 4    ,vid= true	},
+                { id= "tf_aniso"               ,type= "track"    ,val= 2       ,cmd= "r__tf_aniso"                      ,min= 1     ,max= 16    ,step= 4    ,vid= true  },
 		{ id= "ssample"                ,type= "track"    ,val= 2	,cmd= "r__supersample"	            ,min= 1     ,max= 8     ,step= 1       ,vid= true      ,precondition= {for_renderer,"renderer_r1","renderer_r2a","renderer_r2","renderer_r2.5"} },
 		{ id= "ssample_list"           ,type= "list"     ,val= 0	,cmd= "r3_msaa"	                    ,content={ {"st_opt_off","st_opt_off"},{"2x","x2"},{"4x","x4"},{"8x","x8"} }	    ,vid= true          ,precondition= {for_renderer,"renderer_r3","renderer_r4"} , no_str= true  },
 		{ id= "smaa"           		   ,type= "list"     ,val= 0	,cmd= "r2_smaa"	                    ,content={ {"off","st_opt_off"},{"low","st_opt_low"},{"medium","st_opt_medium"},{"high","st_opt_high"},{"ultra","st_opt_ultra"} } ,precondition= {for_renderer,"renderer_r2a","renderer_r2","renderer_r2.5","renderer_r3","renderer_r4"}, no_str= true  },
@@ -429,9 +430,9 @@
 	{ id= "general"      	,sh=true ,gr={
 		{ id= "slide_alife"		,type= "slide"	  ,link= "ui_options_slider_alife"	 ,text= "ui_mm_title_alife"		,size= {512,50}		},
 
-		{ id= "alife_mutant_pop"  		,type= "list"    ,val= 2  ,def= 0.75 	 ,content= {{0.25} , {0.5} , {0.75} , {1}}		,no_str= true  },
-		{ id= "alife_stalker_pop"  		,type= "list"    ,val= 2  ,def= 0.5 	 ,content= {{0.25} , {0.5} , {0.75} , {1}}		,no_str= true  },
-		{ id= "offline_combat"  		,type= "list"    ,val= 0  ,def= "full" 	 ,content= {{"full","full"} , {"on_smarts_only","on_smarts_only"}, {"off","off"}} },
+                { id= "alife_mutant_pop"                ,type= "list"    ,val= 2  ,def= 0.75     ,content= {{0.25} , {0.5} , {0.75} , {1}}              ,no_str= true  },
+                { id= "alife_stalker_pop"               ,type= "list"    ,val= 2  ,def= 0.5      ,content= {{0.25} , {0.5} , {0.75} , {1}}              ,no_str= true  },
+		{ id= "offline_combat"  		,type= "list"    ,val= 0  ,def= "full" 	 ,content= {{"full","full"}, {"on_smarts_only","on_smarts_only"}, {"off","off"}} },
 		{ id= "excl_dist"  				,type= "list"    ,val= 2  ,def= 75 	 	 ,content= {{0} , {25} , {50} , {75} , {100}}	,no_str= true  },
 		{ id= "dynamic_anomalies"        ,type= "check"    ,val= 1	,def= true	 },
 		{ id= "dynamic_relations"        ,type= "check"    ,val= 1	,def= false	 },
```
</details>
| ui_options_modded_exes.script | - | - | missing in gamma |
| ui_paw_reticle.script | - | - | missing in gamma |
| ui_pda_autoinject.script | - | - | missing in gamma |
| ui_pda_diplomacy.script | 0 | 0 | keep |

<details><summary>Diff for ui_pda_diplomacy.script</summary>
```diff
```
</details>
| ui_pda_encyclopedia_tab.script | - | - | missing in gamma |
| ui_pda_glitched_tab.script | - | - | missing in gamma |
| ui_pda_taskboard_tab.script | - | - | missing in gamma |
| ui_pda_warfare_tab.script | 13 | 3 | keep |

<details><summary>Diff for ui_pda_warfare_tab.script</summary>
```diff
--- runtime files/gamedata/scripts/ui_pda_warfare_tab.script
+++ gamma_walo/gamedata/scripts/ui_pda_warfare_tab.script
@@ -3,7 +3,8 @@
 =======================================================================================
 	Original creator: Tronex
 	Edit log: 
-	2020/05/24 - Vintar
+        2020/05/24 - Vintar
+        2025/07/24 - d0pe - clarified tab overview
 
 	New PDA tab for Warfare mode: faction war
 	This file converts the 'contacts' tab into a faction ranking info tab. Faction squad
@@ -17,6 +18,7 @@
 local clr_w,clr_gr
 
 local SINGLETON = nil
+local node_system = require 'node_system'
 function get_ui()
 	SINGLETON = SINGLETON or pda_warfare_tab()
 	SINGLETON:Reset()
@@ -330,5 +332,13 @@
 		self.btn:TextControl():SetText(game.translate_string("pda_all_levels"))
 	end
 	
-	self:Reset()
-end
+        self:Reset()
+end
+
+--- Placeholder callback to upgrade a selected node.
+-- UI integration pending.
+function pda_warfare_tab:upgrade_selected_node(node_id)
+        printf("[PDA] request upgrade for %s", tostring(node_id))
+        -- actual upgrade logic handled in node_system
+        node_system.upgrade_node(node_id)
+end
```
</details>
| ui_rf_widget.script | - | - | missing in gamma |
| ui_sidhud_mcm.script | - | - | missing in gamma |
| ui_sleep_dialog.script | - | - | missing in gamma |
| ui_sr_teleport.script | - | - | missing in gamma |
| ui_stove_furniture.script | - | - | missing in gamma |
| ui_workshop.script | - | - | missing in gamma |
| uni_anim_ammo.script | - | - | missing in gamma |
| uni_anim_core.script | - | - | missing in gamma |
| uni_anim_detectors.script | - | - | missing in gamma |
| uni_anim_knives.script | - | - | missing in gamma |
| unjam_motion_mark.script | - | - | missing in gamma |
| unusable_parts_handler.script | - | - | missing in gamma |
| unusable_parts_handler_mcm.script | - | - | missing in gamma |
| upgrade_rank_pricing.script | - | - | missing in gamma |
| upgrades_mcm.script | - | - | missing in gamma |
| utils_catspaw_common.script | - | - | missing in gamma |
| utils_catspaw_hudmarks.script | - | - | missing in gamma |
| utils_catspaw_mapspots.script | - | - | missing in gamma |
| utils_catspaw_taskmonitor.script | - | - | missing in gamma |
| utils_catspaw_text.script | - | - | missing in gamma |
| utils_slht.script | - | - | missing in gamma |
| utils_ui.script | - | - | missing in gamma |
| utils_ui_custom.script | - | - | missing in gamma |
| utils_ui_icon_rotation_fix_mcm.script | - | - | missing in gamma |
| utils_ui_patch_scrollFix.script | - | - | missing in gamma |
| utjan_mag_check.script | - | - | missing in gamma |
| vehicle_attach_sounds.script | - | - | missing in gamma |
| verbose_logger.script | 0 | 0 | keep |

<details><summary>Diff for verbose_logger.script</summary>
```diff
```
</details>
| visual_memory_manager.script | - | - | missing in gamma |
| vks_custom.script | - | - | missing in gamma |
| vks_trade_inject.script | - | - | missing in gamma |
| void_fmode_sound.script | - | - | missing in gamma |
| void_fmode_sound_mcm.script | - | - | missing in gamma |
| warfare.script | 26 | 2 | keep |

<details><summary>Diff for warfare.script</summary>
```diff
--- runtime files/gamedata/scripts/warfare.script
+++ gamma_walo/gamedata/scripts/warfare.script
@@ -7,13 +7,27 @@
 	2020/10/22 - Vintar - fixed vanilla bug where random patrols were unmarked as random patrols upon game save/load
 	2021/02/16 - Vintar - allowed loner random patrols to be unmarked on game save, so that process_loners() can handle them, saved calculated distances between smart terrains
 	2021/02/22 - Vintar - added initial mutant spawns to non-random start. Random start mutants now spawn on lairs. Under attack status saved
-	2021/03/19 - Vintar - fix for lower population factor initial spawns
+        2021/03/19 - Vintar - fix for lower population factor initial spawns
+        2025/07/24 - d0pe - added verbose logger and helper utilities
 
 	This file deals with warfare's essential data, such as squad registration with warfare,
 	and saving/loading important parameters like respawn timers, squad targets, faction info
 =======================================================================================
 
 --]]
+
+-- Enable verbose debug tracing when requested
+if _G.verbose_logs == 1 then
+    -- Load logger from the same directory as this script so it works both
+    -- when installed under gamedata/ and when running from the repo.
+    local dir = debug.getinfo(1, "S").source
+    dir = dir and dir:gsub("@", ""):match("^(.*[\\/])") or ""
+    local path = dir .. "verbose_logger.script"
+    local ok, err = pcall(dofile, path)
+    if not ok then
+        printf("[VERBOSE] Failed to load logger: %s", tostring(err))
+    end
+end
 
 --_G.DEACTIVATE_SIM_ON_NON_LINKED_LEVELS = false
 --_G.ProcessEventQueueState = function() return end
@@ -478,6 +492,7 @@
 
 FACTION_TERRITORY_RADIUS = 100
 
+-- Fisher-Yates shuffle used for randomizing squad lists
 function shuffleTable( t )
     local rand = math.random 
     local iterations = #t
@@ -911,7 +926,15 @@
 end
 
 function on_game_start()
-	printd(0, "on_game_start")
+        printd(0, "on_game_start")
+
+        -- added require path for .script modules
+        if not package.path:find('gamedata/scripts/%.script', 1, true) then
+                package.path = 'gamedata/scripts/?.script;' .. package.path
+        end
+        if not package.path:find('gamedata/scripts/%.lua', 1, true) then
+                package.path = 'gamedata/scripts/?.lua;' .. package.path
+        end
 	--_G.WARFARE = false
 	warfare_options.update_settings()
 	
@@ -978,6 +1001,7 @@
 	end) return tbl
 end
 
+-- 2D squared distance ignoring Y axis used by AI distance checks
 function distance_to_xz_sqr(a, b)
 	return math.pow(b.x - a.x, 2) + math.pow(b.z - a.z, 2)
 end
```
</details>
| warfare_factions.script | 4 | 2 | keep |

<details><summary>Diff for warfare_factions.script</summary>
```diff
--- runtime files/gamedata/scripts/warfare_factions.script
+++ gamma_walo/gamedata/scripts/warfare_factions.script
@@ -6,7 +6,8 @@
 	2020/11/07 - Vintar - Resurgence chance added to resurgence calculation
 	2021/02/19 - Vintar - stronger resurgence attempts, now uses fetch_smart_distance(), debug messages
 	2021/03/27 - Vintar - loners exempt from random patrol targeting. Random patrols no longer spawn too close to actor.
-	2021/11/22 - Vintar - slight change to resurgence base count
+        2021/11/22 - Vintar - slight change to resurgence base count
+        2025/07/24 - d0pe - added nil checks for faction lists
 
 	This file handles faction-level warfare stuff like random patrols, resurgences, etc.
 =======================================================================================
@@ -55,7 +56,7 @@
 faction_timers = {}
 
 for i=1,#factions do
-	factions_p[factions[i]] = true
+       factions_p[factions[i]] = true
 end
 
 --[[
@@ -82,6 +83,7 @@
 	end
 end
 
+-- Update timers and patrol logic for a single faction
 function update_faction(faction)
 	if (not faction or faction == "none") then
 		return
```
</details>
| warfare_monkeypatches.script | 0 | 0 | keep |

<details><summary>Diff for warfare_monkeypatches.script</summary>
```diff
```
</details>
| warfare_options.script | 3 | 1 | keep |

<details><summary>Diff for warfare_options.script</summary>
```diff
--- runtime files/gamedata/scripts/warfare_options.script
+++ gamma_walo/gamedata/scripts/warfare_options.script
@@ -8,7 +8,8 @@
 	2021/02/13 - Vintar - reads in overflow override, loner fog of war
 	2021/02/16 - Vintar - added min smart targets per base
 	2021/11/09 - Vintar - added goodwill on kill options, added back "hide all smarts" option, added 'old autocapture' option
-	2022/02/26 - Vintar - added main base attack deprioritization option
+        2022/02/26 - Vintar - added main base attack deprioritization option
+        2025/07/24 - d0pe - added random start helper
 
 	This file reads the main menu options for warfare so that script functions can access them.
 =======================================================================================
@@ -228,6 +229,7 @@
 	sim_squad_scripted.sim_squad_scripted.specific_update = function(self, script_target_id) end
 end
 
+-- Pick a random start location from faction lists
 function get_random_start_location()
 	warfare.printd(0, "get_random_start_location")
 
```
</details>
| weapon_cover_tilt.script | - | - | missing in gamma |
| weapon_cover_tilt_gun_trigger_radii.script | - | - | missing in gamma |
| weapon_cover_tilt_gun_trigger_radii_fire_bone.script | - | - | missing in gamma |
| weapon_cover_tilt_ignore_phantoms.script | - | - | missing in gamma |
| weapon_cover_tilt_mcm.script | - | - | missing in gamma |
| weapon_cover_tilt_positions.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_DEG.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_TFCWP.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_ace.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_am17.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_ar_pack.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_bas.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_bas2022.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_benelli_m1014.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_berettas.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_blindsides.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_dtmdr.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_eft_rsh12.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_firebreath.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_g36rwap.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_grok.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_mossberg.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_oleh.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_p90gamma.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_rpk.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_souvlakis.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_spas12.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_udp9.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_xm4.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_z_oleh.script | - | - | missing in gamma |
| weapon_cover_tilt_positions_z_vityaz_virilized.script | - | - | missing in gamma |
| weapon_cover_tilt_positons_saiga.script | - | - | missing in gamma |
| weapon_cover_tilt_rattle.script | - | - | missing in gamma |
| weapon_showcase.script | - | - | missing in gamma |
| weapon_sprint_rattle.script | - | - | missing in gamma |
| weight.script | - | - | missing in gamma |
| weight_of_catergory.script | - | - | missing in gamma |
| wepl_hit_effect.script | - | - | missing in gamma |
| wepl_hit_effect_mcm.script | - | - | missing in gamma |
| workshop_autoinject.script | - | - | missing in gamma |
| workshop_tool.script | - | - | missing in gamma |
| wpn_sway_enable.script | - | - | missing in gamma |
| wpn_thompson_mcm.script | - | - | missing in gamma |
| wpo_loot.script | - | - | missing in gamma |
| xcv_phantoms.script | - | - | missing in gamma |
| xr_campfire_point.script | - | - | missing in gamma |
| xr_combat_camper.script | - | - | missing in gamma |
| xr_combat_ignore.script | - | - | missing in gamma |
| xr_companion.script | - | - | missing in gamma |
| xr_cond_snipers_add.script | - | - | missing in gamma |
| xr_conditions.script | - | - | missing in gamma |
| xr_danger.script | - | - | missing in gamma |
| xr_effects.script | - | - | missing in gamma |
| xr_logic.script | 1 | 0 | keep |

<details><summary>Diff for xr_logic.script</summary>
```diff
--- runtime files/gamedata/scripts/xr_logic.script
+++ gamma_walo/gamedata/scripts/xr_logic.script
@@ -36,6 +36,7 @@
 	end
 end
 
+-- Spawn configured items into an NPCs inventory during initialization
 function spawn_items(npc, st)
 	--utils_data.debug_write("spawner:spawn_items")
 	if not (st.ini and st.section_logic) then 
```
</details>
| xr_meet.script | - | - | missing in gamma |
| xr_reach_task.script | - | - | missing in gamma |
| xr_wounded.script | - | - | missing in gamma |
| xrs_facer.script | - | - | missing in gamma |
| xrs_rnd_npc_loadout.script | - | - | missing in gamma |
| z_3d_init.script | - | - | missing in gamma |
| z_3d_scopes.script | - | - | missing in gamma |
| z_3d_scopes_mcm.script | - | - | missing in gamma |
| z_apm_popup_pickup_dotmarks.script | - | - | missing in gamma |
| z_auto_looter.script | - | - | missing in gamma |
| z_auto_proximity_looter.script | - | - | missing in gamma |
| z_barrier_defense_emission_fix.script | - | - | missing in gamma |
| z_beefs_nvgs.script | - | - | missing in gamma |
| z_beefs_nvgs_mcm.script | - | - | missing in gamma |
| z_companions_dont_blow_disguises.script | - | - | missing in gamma |
| z_dyn_news_heard_melee_fix.script | - | - | missing in gamma |
| z_dyn_news_task_gossip_fix.script | - | - | missing in gamma |
| z_enhanced_animations_hud_fov_fix.script | - | - | missing in gamma |
| z_fdda_pickup_intercept_dotmarks.script | - | - | missing in gamma |
| z_fetch_shows_count.script | - | - | missing in gamma |
| z_gavrilenko_tasks_fix.script | - | - | missing in gamma |
| z_haru_skills_dotmarks_monitor.script | - | - | missing in gamma |
| z_headgear_animations_fdda_strict_helmets.script | - | - | missing in gamma |
| z_headgear_animations_fddapickup_patch.script | - | - | missing in gamma |
| z_hf_furniture_types_init_stash_name.script | - | - | missing in gamma |
| z_idiots_patches.script | - | - | missing in gamma |
| z_item_icon_info.script | - | - | missing in gamma |
| z_liz_fdda_redone_headlamp.script | - | - | missing in gamma |
| z_liz_fdda_redone_mask_clean.script | - | - | missing in gamma |
| z_liz_fdda_redone_western_goods_patch.script | - | - | missing in gamma |
| z_mark_switch.script | - | - | missing in gamma |
| z_mark_switch_mcm.script | - | - | missing in gamma |
| z_monkey_toolkit_workshop.script | - | - | missing in gamma |
| z_more_measurement_task_maps.script | - | - | missing in gamma |
| z_new_tasks_addon_state_lib.script | - | - | missing in gamma |
| z_npc_footsteps.script | - | - | missing in gamma |
| z_npc_wounded_animation_fix_mcm.script | - | - | missing in gamma |
| z_nta_compatibility.script | - | - | missing in gamma |
| z_nta_stashes_utils.script | - | - | missing in gamma |
| z_nta_xr_conditions.script | - | - | missing in gamma |
| z_nta_xr_effects.script | - | - | missing in gamma |
| z_parts_inject.script | - | - | missing in gamma |
| z_pda_interactive_monkeypatch.script | - | - | missing in gamma |
| z_ph_door_bar_arena_remover.script | - | - | missing in gamma |
| z_rftip_note_spawner.script | - | - | missing in gamma |
| z_scale_equipped_guns.script | - | - | missing in gamma |
| z_serious_monkey_ui_debug_launcher.script | - | - | missing in gamma |
| z_sr_psy_antenna_no_sound_mute.script | - | - | missing in gamma |
| z_surge_crow_killer_fix.script | - | - | missing in gamma |
| z_task_marker_delivery_fix.script | - | - | missing in gamma |
| z_taskboard_overrides.script | - | - | missing in gamma |
| z_ui_inventory_dotmarks.script | - | - | missing in gamma |
| z_workshop_tool_double_click_open_tools.script | - | - | missing in gamma |
| z_z_item_icon_info.script | - | - | missing in gamma |
| zatura_autostack.script | - | - | missing in gamma |
| zone_keeper.script | - | - | missing in gamma |
| zone_keeper_mcm.script | - | - | missing in gamma |
| zz_Cost_in_tool_tip.script | - | - | missing in gamma |
| zz_Encyclopedia_messages_restored.script | - | - | missing in gamma |
| zz_artefacts_belt_scroller_data.script | - | - | missing in gamma |
| zz_artefacts_belt_scroller_ui.script | - | - | missing in gamma |
| zz_autoloot_dotmarks.script | - | - | missing in gamma |
| zz_companion_inventory_fix_mcm.script | - | - | missing in gamma |
| zz_glowstick_mcm.script | - | - | missing in gamma |
| zz_item_artefact.script | - | - | missing in gamma |
| zz_item_artefact_mcm.script | - | - | missing in gamma |
| zz_item_cooking_keep_crafting_window_open.script | - | - | missing in gamma |
| zz_item_parts_prefer_best_disassembly_tool.script | - | - | missing in gamma |
| zz_item_repair_keep_crafting_window_open.script | - | - | missing in gamma |
| zz_itms_manager_more_drops_from_drugs.script | - | - | missing in gamma |
| zz_liz_fdda_redone_headgear_animations_strict_helmets.script | - | - | missing in gamma |
| zz_liz_fdda_redone_outfit_patches.script | - | - | missing in gamma |
| zz_monkey_z_fetch_shows_count.script | - | - | missing in gamma |
| zz_npc_loot_claim_softcore.script | - | - | missing in gamma |
| zz_parts_in_tooltip.script | - | - | missing in gamma |
| zz_rf_light_remover.script | - | - | missing in gamma |
| zz_surge_manager_npc_die.script | - | - | missing in gamma |
| zz_time_events_keep_crafting_window_open.script | - | - | missing in gamma |
| zz_treasure_manager_pba_less_artys.script | - | - | missing in gamma |
| zz_ui_inventory_better_stats_bars.script | - | - | missing in gamma |
| zz_ui_itm_details_repair_bonuses.script | - | - | missing in gamma |
| zz_ui_workshop_keep_crafting_window_open.script | - | - | missing in gamma |
| zzz_bas_laser_control.script | - | - | missing in gamma |
| zzz_craft_use_in_tooltip_mcm.script | - | - | missing in gamma |
| zzz_dit.script | - | - | missing in gamma |
| zzz_ea_addon_backpack.script | - | - | missing in gamma |
| zzz_faction_expansions_loadall.script | - | - | missing in gamma |
| zzz_grok_artefacts_melter_utility.script | - | - | missing in gamma |
| zzz_grok_mutant_pelts_utjan_cond_pos.script | - | - | missing in gamma |
| zzz_item_parts_milpda.script | - | - | missing in gamma |
| zzz_mspizza_Godis_ZoomCalc.script | - | - | missing in gamma |
| zzz_player_injuries.script | - | - | missing in gamma |
| zzz_player_injuries_mcm.script | - | - | missing in gamma |
| zzz_rax_sortingplus_mcm.script | - | - | missing in gamma |
| zzz_sim_squad_scripted_milpda.script | - | - | missing in gamma |
| zzz_stop_addon_log_spam.script | - | - | missing in gamma |
| zzz_timsi_ui_workshop.script | - | - | missing in gamma |
| zzz_ui_pda_npc_tab_milpda.script | - | - | missing in gamma |
| zzz_workshop_return_items.script | - | - | missing in gamma |
| zzz_zone_keeper_mp.script | - | - | missing in gamma |
| zzzz_arti_jamming_repairs.script | - | - | missing in gamma |
| zzzz_liz_fdda_redone_hideout_furniture_patch.script | - | - | missing in gamma |
| zzzz_liz_fdda_redone_ledge_grabbing_patch.script | - | - | missing in gamma |
| zzzz_liz_fdda_redone_ui_inventory.script | - | - | missing in gamma |
| zzzz_serious_ui_workshop.script | - | - | missing in gamma |
| zzzz_wounded_heal_anim_dotmarks.script | - | - | missing in gamma |
| zzzzz_ui_pda_npc_tab_wpnhidefix.script | - | - | missing in gamma |
| zzzzz_ui_workshop_repair_patch.script | - | - | missing in gamma |
| zzzzzz_ui_pda_npc_tab_mpdaprogressive.script | - | - | missing in gamma |
| zzzzzzz_repair_modifiers.script | - | - | missing in gamma |
| squad_loot_recovery.script | new file | - | new module |