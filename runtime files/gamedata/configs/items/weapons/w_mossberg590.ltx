; used the EFP mossberg590 as template - credits to Maid ig

[wpn_mossberg590]:identity_immunities,weapon_probability,default_weapon_params,wpn_mp133_sounds

        GroupControlSection         = spawn_group
        $npc                        = on
        $prefetch                   = 8
        $spawn                      = "weapons\mossberg590"
        scheduled                   = off
        cform                       = skeleton
        parent_section              = wpn_mossberg590
        
        class                       = WP_ASHTG
        slot                        = 2
        animation_slot              = 9
        ef_main_weapon_type         = 1
        ef_weapon_type              = 9
        hand_dependence             = 1
        single_handed               = 0
		
		icons_texture					 = ui\wpn_mossberg590a1_icon
		inv_grid_width					 = 6
		inv_grid_height					 = 2
		inv_grid_x						 = 0
		inv_grid_y						 = 2

		upgr_icon_path					 = ui\wpn_mossberg590a1_upgr
		upgr_icon_x						 = 0
		upgr_icon_y						 = 0
		upgr_icon_width					 = 300
		upgr_icon_height				 = 100

        inv_name                    = st_wpn_mossberg590a1
        inv_name_short              = st_wpn_mossberg590a1_s
        description                 = st_wpn_mossberg590a1_descr
        
        kind                        = w_shotgun
        inv_weight                  = 3.2
        cost                        = 19960
        repair_type                 = shotgun
        weapon_class                = shotgun

        hud                         = wpn_mossberg590_hud
        visual                      = dynamics\weapons\wpn_mossberg590a1\wpn_mossberg590a1_world.ogf
        position                         = -0.023841, -0.005364, 0.036418
        orientation                      = 4, -5, 12
        fire_point                  = 0, 0.069, 0.76
        fire_point2                 = 0, 0.069, 0.76
        strap_bone0                 = bip01_spine2
        strap_bone1                 = bip01_spine1
        strap_position              = -0.22, -0.14, 0.16
        strap_orientation           = -15, -9, 110
        ph_mass                     = 3
        
        flame_particles                          = weapons\generic_weapon05
        smoke_particles                          = amik\weapons\smoke_particles\smoke_particles_pump_01
        
	shell_point					= 0,0.05,0.085
	shell_particles				= weapons\12ga_buckshot ; for npcs

        light_color                 = 0.6, 0.5, 0.3
        light_range                 = 6.0
        light_time                  = 0.2
        light_var_color             = 0.05
        light_var_range             = 0.5
        
        upgrades                    = up_gr_firstab_mp133, up_gr_seconab_mp133, up_gr_thirdab_mp133, up_gr_fourtab_mp133
        installed_upgrades          =
        upgrade_scheme              = upgrade_scheme_wincheaster1300
        ;upgr_icon_x                 = 1450
        ;upgr_icon_y                 = 1150
        ;upgr_icon_width             = 300
        ;upgr_icon_height            = 50
        
        tri_state_reload            = on
        fire_modes                  = 1
        ammo_class                  = ammo_12x70_buck, ammo_12x70_buck_bad, ammo_12x70_buck_verybad, ammo_12x76_zhekan, ammo_12x76_zhekan_bad, ammo_12x76_zhekan_verybad, ammo_12x76_dart, ammo_12x76_dart_bad, ammo_12x76_dart_verybad; ammo_12x70_buck_self
        ammo_elapsed                = 9
        ammo_mag_size               = 9
        startup_ammo                = 10
        
        scopes 	                    = 
        scope_status                = 0
        scope_zoom_factor           = 0
        

        silencer_status                          = 0

        grenade_launcher_status     = 0
        
        hit_impulse                 = 35
        hit_power                   = 0.79, 0.79, 0.79, 0.79
        hit_type                    = fire_wound
        fire_distance               = 1000
        bullet_speed                = 340
        rpm                         = 90
        rpm_empty_click             = 200
        
        zoom_dof                    = 0.5, 1.0, 180
        zoom_enabled                = true
        zoom_rotate_time			= 0.2
        control_inertion_factor = 1.0f
        crosshair_inertion          = 6.5
        fire_dispersion_base        = 0.454
        fire_dispersion_condition_factor = 0.001
        
        misfire_probability         = 0.005 ; 0.005
        misfire_start_condition     = 0.7 ;  0.91
        misfire_start_prob          = 0.007 ; 0.007
        misfire_end_condition       = 0.16 ; 0.16
        misfire_end_prob            = 0.11 ; 0.11
        
        condition_queue_shot_dec    = 0.0026
        condition_shot_dec          = 0.0026
        
        cam_return                  = 0
        cam_relax_speed             = 20
        cam_dispersion              = 6.4
        cam_dispersion_frac         = 0.9
        cam_dispersion_inc          = 5.2
        cam_max_angle               = 50.0
        cam_max_angle_horz          = 50.0
        cam_step_angle_horz         = 2.35
        zoom_cam_relax_speed        = 16
        zoom_cam_dispersion         = 5.84
        zoom_cam_dispersion_frac    = 0.63
        zoom_cam_dispersion_inc     = 4.3
        zoom_cam_max_angle          = 50.0
        zoom_cam_max_angle_horz     = 50.0
        zoom_cam_step_angle_horz    = 2.28
        
        PDM_disp_accel_factor       = 1.85
        PDM_disp_base               = 1.7
        PDM_disp_crouch             = 1.0
        PDM_disp_crouch_no_acc      = 1.0
        PDM_disp_vel_factor         = 1.8
        
        cam_relax_speed_ai          = 360
        zoom_cam_relax_speed_ai     = 120.75
        holder_fov_modifier         = 1.0
        holder_range_modifier       = 1.0
        min_radius                  = 0
        max_radius                  = 500
        hit_probability_gd_novice   = 1.00
        hit_probability_gd_stalker  = 1.00
        hit_probability_gd_veteran  = 1.00
        hit_probability_gd_master   = 1.00
        
        kill_msg_x                  = 171
        kill_msg_y                  = 104
        kill_msg_width              = 75
        kill_msg_height             = 20


; wpn_hud
[wpn_mossberg590_hud]:hud_base
item_visual                              = anomaly_weapons\wpn_mossberg590a1\wpn_mossberg590a1_hud.ogf
        attach_place_idx            = 0
        zoom_hide_crosshair         = true
        
                
; positions
	
        item_position				= 0, 0, 0
        item_orientation			= 0, 0, 0

        hands_position              = 0, 0, 0
        hands_position_16x9         = 0, 0, 0
        hands_orientation                = 0, 0, 0
        hands_orientation_16x9           = 0, 0, 0
	
        aim_hud_offset_pos               = 0, 0.00015, 0
        aim_hud_offset_pos_16x9          = 0, 0.00015, 0
        aim_hud_offset_rot               = 0.003, 0, 0
        aim_hud_offset_rot_16x9          = 0.003, 0, 0

        lowered_hud_offset_pos			= 0.065, -0.036, -0.02
        lowered_hud_offset_pos_16x9		= 0.065, -0.036, -0.02
        lowered_hud_offset_rot			= -0.1, -0.63, 0.4
        lowered_hud_offset_rot_16x9		= -0.1, -0.63, 0.4


; basic anms
        
        anm_show = h_m590_draw, m590_draw
        anm_hide = h_m590_holster, m590_holster

        anm_idle = h_m590_idle, m590_idle
        anm_idle_variant1 = h_m590_idle_v2, m590_idle
        anm_idle_variant2 = h_m590_idle_v3, m590_idle   ; extended h_m590_idle_v1, m590_idle
        
        anm_idle_aim = h_m590_aim, m590_idle
        ; anm_idle_aim = h_m590_aim_swayless, m590_idle   ; for testing sights
        anm_idle_moving = h_m590_walk, m590_idle, 0.9
        anm_idle_moving_crouch = h_m590_walk, m590_idle, 0.75
        anm_idle_moving_empty_crouch = h_m590_walk, m590_idle, 0.75
        anm_idle_sprint = h_m590_sprint, m590_idle, 1.2

        anm_idle_aim_move = h_m590_walk_aim, m590_idle, 0.8
        anm_idle_moving_crouch_aim = h_m590_walk_aim, m590_idle, 0.45
        anm_idle_moving_crouch_empty_aim = h_m590_walk_aim, m590_idle, 0.45

        anm_shots = h_m590_shoot, m590_shoot
        anm_shots_variant1 = h_m590_shoot_01, m590_shoot_01
        anm_shots_variant2 = h_m590_shoot_02, m590_shoot_02
        anm_shots_aim = h_m590_shoot_aim, m590_shoot_aim
        anm_shots_aim_variant1 = h_m590_shoot_aim_01, m590_shoot_aim_01
        anm_shots_aim_variant2 = h_m590_shoot_aim_02, m590_shoot_aim_02
        

        ; overclamplicated reload
        anm_open_empty = h_m590_open_empty, m590_open_empty, 1.15
        anm_open_ammo1 = h_m590_open_ammo1, m590_open_ammo1, 1.15
        ;anm_open_ammoeven = h_m590_open_ammo3, m590_open_ammo3, 1.15 ; it doesnt exist
        anm_open_ammoodd = h_m590_open_ammo2, m590_open_ammo2, 1.15

        anm_add_cartridge_empty = h_m590_load_empty, m590_load_empty, 1.15
        anm_add_cartridge_ammo1 = h_m590_load_ammo1, m590_load_ammo1, 1.15
        anm_add_cartridge_ammoeven = h_m590_load_ammo2, m590_load_ammo2, 1.15
        anm_add_cartridge_ammoodd = h_m590_load_ammo3, m590_load_ammo3, 1.15

        anm_close_ammo1 = h_m590_close_ammo1, m590_close_ammo1, 1.15
        anm_close_ammoodd = h_m590_close_ammo3, m590_close_ammo3, 1.15
        anm_close_ammoeven = h_m590_close_ammo4, m590_close_ammo4, 1.15

        ; placeholders (needed for npcs for some reason)
        anm_open = h_m590_open_ammo2, m590_open_ammo2, 1.15
        anm_add_cartridge = h_m590_load_ammo3, m590_load_ammo3, 1.15
        anm_close = h_m590_close_ammo4, m590_close_ammo4, 1.15

        
        ; magcheck tubecheck
        anm_ammo_check = h_m590_magcheck, m590_idle
        anm_ammo_check_ammo1 = h_m590_magcheck, m590_magcheck_empty
        anm_ammo_check_empty = h_m590_magcheck, m590_magcheck_empty
        anm_ammo_check_aim = h_m590_magcheck_aim, m590_magcheck_aim
        anm_ammo_check_empty_aim = h_m590_magcheck_aim, m590_magcheck_empty_aim

        ; inspect
        anm_bore = h_m590_inspect, m590_idle
        anm_bore_aim = h_m590_inspect_aim, m590_idle

        anm_empty_fire = h_m590_shoot_empty, m590_shoot_empty
        anm_empty_fire_aim = h_m590_shoot_empty_aim, m590_shoot_empty_aim
        
        ; jammed
        
        ; anm_reload_misfire = h_m590_misfire, m590_misfire
        anm_reload_misfire = h_m590_unjam, m590_unjam
        anm_reload_misfire_aim = h_m590_unjam_aim, m590_unjam_aim
        anm_reload_misfire_jammed = h_m590_unjam, m590_unjam
        anm_reload_misfire_aim_jammed = h_m590_unjam_aim, m590_unjam_aim

        anm_idle_jammed = h_m590_idle_jammed, m590_idle_jammed
        anm_idle_aim_jammed = h_m590_aim_jammed, m590_idle_jammed
        anm_idle_moving_jammed = h_m590_walk_jammed, m590_idle_jammed, 0.9
        anm_idle_moving_crouch_jammed = h_m590_walk_jammed, m590_idle_jammed, 0.75
        anm_idle_moving_empty_crouch_jammed = h_m590_walk_jammed, m590_idle_jammed, 0.75
        anm_idle_sprint_jammed = h_m590_sprint_jammed, m590_idle_jammed, 1.2

        anm_shots_jammed = h_m590_shoot_jammed, m590_shoot_jammed
        anm_show_jammed = h_m590_draw_jammed, m590_draw_jammed
        anm_hide_jammed = h_m590_holster_jammed, m590_holster_jammed

        anm_bore_jammed = h_m590_inspect_jammed, m590_idle_jammed
        anm_bore_aim_jammed = h_m590_inspect_aim_jammed, m590_idle_jammed

        anm_ammo_check_jammed = h_m590_inspect_jammed, m590_idle_jammed
        anm_ammo_check_empty_jammed = h_m590_inspect_jammed, m590_idle_jammed
        anm_ammo_check_aim_jammed = h_m590_inspect_aim_jammed, m590_idle_jammed
        anm_ammo_check_empty_aim_jammed = h_m590_inspect_aim_jammed, m590_idle_jammed


        ; the many many many mamy many transitions

        ts_pattern_closeammo1 = anm_add_cartridge_empty, ^anm_idle.*, anm_close_ammo1, 1
        ts_pattern_closeammo2 = anm_add_cartridge_ammo1, ^anm_idle.*, anm_close_ammoeven, 1
        ts_pattern_closeodd = anm_add_cartridge_ammoeven, ^anm_idle.*, anm_close_ammoodd, 1
        ts_pattern_closeeven = anm_add_cartridge_ammoodd, ^anm_idle.*, anm_close_ammoeven, 1


        ts_pattern_idle2aim = ^anm_idle$, ^anm_idle_aim.*, anm_idle2aim, 4
        ts_pattern_var2aim = ^anm_idle_variant.*, ^anm_idle_aim.*, anm_idle2aim, 4
        ts_pattern_jam2aim = ^anm_idle_jammed.*, ^anm_idle_aim.*, anm_idle2aim, 4
        ts_pattern_moving2aim = ^anm_idle_moving.*, ^anm_idle_aim.*, anm_idle2aim, 4
        ts_pattern_sprint2aim = ^anm_idle_sprint.*, ^anm_idle_aim.*, anm_sprint2aim, 2
        ;ts_pattern_a2i2aim = ^anm_aim2idle.*, ^anm_idle_aim.*, anm_idle2aim, 1

        anm_idle2aim = h_m590_idle2aim, m590_idle
        anm_idle2aim_jammed = h_m590_idle2aim_jammed, m590_idle_jammed

        anm_sprint2aim = h_m590_sprint2aim, m590_idle, 1.1
        anm_sprint2aim_jammed = h_m590_sprint2aim_jammed, m590_idle_jammed, 1.1


        ts_pattern_aim2idle = ^anm_idle_aim.*, ^anm_idle$, anm_aim2idle, 4
        ts_pattern_aim2var = ^anm_idle_aim.*, ^anm_idle_variant.*, anm_aim2idle, 4
        ts_pattern_aim2jam = ^anm_idle_aim.*, ^anm_idle_jammed.*, anm_aim2idle, 4
        ts_pattern_aim2moving = ^anm_idle_aim.*, ^anm_idle_moving.*, anm_aim2idle, 4
        ts_pattern_aim2sprint = ^anm_idle_aim.*, ^anm_idle_sprint.*, anm_aim2idle, 4
        ;ts_pattern_i2a2idle = ^anm_idle2aim.*, ^anm_idle$, anm_aim2idle, 1
        ;ts_pattern_i2a2idle_fix = ^anm_idle2aim.*, ^anm_idle_.*, anm_aim2idle, 1

        anm_aim2idle = h_m590_aim2idle, m590_idle
        anm_aim2idle_jammed = h_m590_aim2idle_jammed, m590_idle_jammed


        ts_pattern_idle2sprint = ^anm_idle.*, ^anm_idle_sprint.*, anm_idle2sprint, 3
        anm_idle2sprint = h_m590_idle2sprint, m590_idle, 1.2
        anm_idle2sprint_jammed = h_m590_idle2sprint_jammed, m590_idle_jammed, 1.2

        ts_pattern_sprint2idle = ^anm_idle_sprint.*, ^anm_idle.*, anm_sprint2idle, 3
        anm_sprint2idle = h_m590_sprint2idle, m590_idle
        anm_sprint2idle_jammed = h_m590_sprint2idle_jammed, m590_idle_jammed


; whatever these are

        shell_bone                  = shell_00
        shell_dir                   = 0, 1, 0
        shell_point                 = 0, -10, 0
                
        fire_bone                   = muzzle
        fire_point                  = 0.0, 0.0, 0.0
         
        freelook_z_offset_mul		= 0.3


; wood variant

[wpn_mossberg590_wood]:wpn_mossberg590
        $spawn                      = "weapons\mossberg590_wood"
        parent_section              = wpn_mossberg590_wood
        scopes = 
        hud                         = wpn_mossberg590_wood_hud

        inv_name                    = st_wpn_mossberg590a1_wood
        inv_name_short              = st_wpn_mossberg590a1_wood_s
        description                 = st_wpn_mossberg590a1_wood_descr

        visual                      = dynamics\weapons\wpn_mossberg590a1\wpn_mossberg590a1_wood_world.ogf
        upgr_icon_x						 = 0
        upgr_icon_y						 = 200
        inv_grid_x						 = 0
        inv_grid_y						 = 4

        inv_weight					= 3.52

        misfire_probability         = 0.004 ; 0.005
        misfire_start_condition     = 0.69 ;  0.91
        misfire_start_prob          = 0.006 ; 0.007
        misfire_end_condition       = 0.16 ; 0.16
        misfire_end_prob            = 0.11 ; 0.11
[wpn_mossberg590_wood_hud]:wpn_mossberg590_hud
        item_visual                              = anomaly_weapons\wpn_mossberg590a1\wpn_mossberg590a1_wood_hud.ogf
        aim_hud_offset_pos               = 0, 0.00015, 0
        aim_hud_offset_pos_16x9          = 0, 0.00015, 0
        aim_hud_offset_rot               = 0.003, 0, 0
        aim_hud_offset_rot_16x9          = 0.003, 0, 0


; railed

[wpn_mossberg590_rail]:wpn_mossberg590
        $spawn                      = "weapons\mossberg590_rail"
        parent_section              = wpn_mossberg590_rail
        scopes 	                    = ac10632, acog, eot
        hud                         = wpn_mossberg590_rail_hud

        inv_name                    = st_wpn_mossberg590a1_rail
        inv_name_short              = st_wpn_mossberg590a1_rail_s
        description                 = st_wpn_mossberg590a1_rail_descr

        visual                      = dynamics\weapons\wpn_mossberg590a1\wpn_mossberg590a1_rail_world.ogf
        upgr_icon_x						 = 0
        upgr_icon_y						 = 100
        inv_grid_x						 = 0
        inv_grid_y						 = 0

        inv_weight					= 3.2
[wpn_mossberg590_rail_hud]:wpn_mossberg590_hud
        item_visual                              = anomaly_weapons\wpn_mossberg590a1\wpn_mossberg590a1_rail_hud.ogf
        aim_hud_offset_pos               = 0, 0.004, 0
        aim_hud_offset_pos_16x9          = 0, 0.004, 0
        aim_hud_offset_rot               = 0.008, 0, 0
        aim_hud_offset_rot_16x9          = 0.008, 0, 0


; sights

[wpn_mossberg590_rail_acog]:wpn_mossberg590_rail
        hud                         = wpn_mossberg590_rail_acog_hud

        1icon_layer					= acog
        1icon_layer_x				= 102
        1icon_layer_y				= -1
        
        inv_weight					= 3.55
        
        scope_status				= 1
        scope_texture				= wpn_crosshair_acog
        scope_zoom_factor			= 18
        zoom_rotate_time			= 0.35
        scope_dynamic_zoom			= off
[wpn_mossberg590_rail_acog_hud]:wpn_mossberg590_rail_hud
        item_visual                              = anomaly_weapons\wpn_mossberg590a1\wpn_mossberg590a1_acog_hud.ogf
        aim_hud_offset_pos               = 0, -0.026, -0.07
        aim_hud_offset_pos_16x9          = 0, -0.026, -0.07
        aim_hud_offset_rot               = 0.0, 0, 0
        aim_hud_offset_rot_16x9          = 0.0, 0, 0
        

[wpn_mossberg590_rail_ac10632]:wpn_mossberg590_rail
        hud                         = wpn_mossberg590_rail_ac10632_hud

        1icon_layer					= ac10632
        1icon_layer_x				= 108
        1icon_layer_y				= -4
        
        zoom_rotate_time			= 0.5

        inv_weight					= 3.5
[wpn_mossberg590_rail_ac10632_hud]:wpn_mossberg590_rail_hud
        item_visual                              = anomaly_weapons\wpn_mossberg590a1\wpn_mossberg590a1_ac10632_hud.ogf
        aim_hud_offset_pos               = 0, -0.026, 0
        aim_hud_offset_pos_16x9          = 0, -0.026, 0
        aim_hud_offset_rot               = 0.0, 0, 0
        aim_hud_offset_rot_16x9          = 0.0, 0, 0
        

[wpn_mossberg590_rail_eot]:wpn_mossberg590_rail
        hud                         = wpn_mossberg590_rail_eot_hud

        1icon_layer					= eot
        1icon_layer_x				= 110
        1icon_layer_y				= 0

        zoom_rotate_time			= 0.5

        inv_weight					= 3.5
[wpn_mossberg590_rail_eot_hud]:wpn_mossberg590_rail_hud
        item_visual                              = anomaly_weapons\wpn_mossberg590a1\wpn_mossberg590a1_eot_hud.ogf
        aim_hud_offset_pos               = 0, -0.0345, 0
        aim_hud_offset_pos_16x9          = 0, -0.0345, 0
        aim_hud_offset_rot               = 0.0, 0, 0
        aim_hud_offset_rot_16x9          = 0.0, 0, 0